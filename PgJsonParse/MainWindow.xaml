<Window x:Class="PgJsonParse.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:conv="clr-namespace:Converters"
        xmlns:app="clr-namespace:PgJsonParse"
        xmlns:obj="clr-namespace:PgJsonObjects;assembly=PgJsonObjects"
        Title="Project Gorgon - Json Parser">
    <Window.Resources>
        <conv:BooleanToObjectConverter x:Key="convBooleanToObject"/>
        <conv:IndexToObjectConverter x:Key="convIndexToObject"/>
        <conv:EnumToTextConverter x:Key="convEnumToText"/>
        <conv:FriendlyNameConverter x:Key="convFriendlyName"/>
        <conv:FileNameToBitmapImageConverter x:Key="convFileNameToBitmapImage"/>
        <conv:NullableIntConverter x:Key="convNullableInt"/>
        <conv:FloatListToStringConverter x:Key="convFloatListToString"/>
        <conv:IntToObjectConverter x:Key="convIntToObject"/>
        <conv:NullToObjectConverter x:Key="convNullToObject"/>
        <conv:DoubleConverter x:Key="convDouble"/>
        <conv:RgbColorToBrushConverter x:Key="convRgbColorToBrush"/>
        <conv:ReplaceMacroConverter x:Key="convReplaceMacro"/>
        <conv:AndConverter x:Key="convAnd"/>
        <conv:OrConverter x:Key="convOr"/>
        <conv:NullableIntToTimeConverter x:Key="convNullableIntToTime"/>
        <conv:MultiStringConverter x:Key="convMultiString"/>
        <conv:ConstantConverter x:Key="convConstant"/>
        <conv:NullableTimeSpanToDurationConverter x:Key="convNullableTimeSpanToDuration"/>
        <conv:IsEnumInSetConverter x:Key="convIsEnumInSet"/>
        <conv:IntThresholdConverter x:Key="convIntThreshold"/>
        <app:ItemEffectGearSelector x:Key="selItemEffectGear"/>
        <app:LinkBackSelector x:Key="selLinkBack"/>
        <app:ListMemberSelector x:Key="selListMember"/>
        <app:SearchResultTitleSelector x:Key="selSearchResultTitle"/>
        <app:SearchResultContentSelector x:Key="selSearchResultContent"/>
        <app:SkillRewardSelector x:Key="selSkillReward"/>
        <app:TypeToTemplateNameSelector x:Key="setTypeToTemplateName"/>
        <RoutedCommand x:Key="StartApplicationCommand"/>
        <RoutedCommand x:Key="ClearVersionListCommand"/>
        <RoutedCommand x:Key="CancelCommand"/>
        <RoutedCommand x:Key="AddPowerCommand"/>
        <RoutedCommand x:Key="RemovePowerCommand"/>
        <RoutedCommand x:Key="LoadBuildCommand"/>
        <RoutedCommand x:Key="SaveBuildCommand"/>
        <RoutedCommand x:Key="CopyBuildCommand"/>
        <RoutedCommand x:Key="CrunchCommand"/>
        <RoutedCommand x:Key="OpenProfileFolderCommand"/>
        <RoutedCommand x:Key="BackwardCommand"/>
        <RoutedCommand x:Key="ForwardCommand"/>
        <CompositeCollection x:Key="VisibleHidden">
            <Visibility>Visible</Visibility>
            <Visibility>Hidden</Visibility>
        </CompositeCollection>
        <CompositeCollection x:Key="HiddenVisible">
            <Visibility>Hidden</Visibility>
            <Visibility>Visible</Visibility>
        </CompositeCollection>
        <CompositeCollection x:Key="VisibleCollapsed">
            <Visibility>Visible</Visibility>
            <Visibility>Collapsed</Visibility>
        </CompositeCollection>
        <CompositeCollection x:Key="CollapsedVisible">
            <Visibility>Collapsed</Visibility>
            <Visibility>Visible</Visibility>
        </CompositeCollection>
        <CompositeCollection x:Key="CollapsedVisibleCollapsed">
            <Visibility>Collapsed</Visibility>
            <Visibility>Visible</Visibility>
            <Visibility>Collapsed</Visibility>
        </CompositeCollection>
        <CompositeCollection x:Key="CollapsedCollapsedVisible">
            <Visibility>Collapsed</Visibility>
            <Visibility>Collapsed</Visibility>
            <Visibility>Visible</Visibility>
        </CompositeCollection>
        <CompositeCollection x:Key="NoYes">
            <sys:String>No</sys:String>
            <sys:String>Yes</sys:String>
        </CompositeCollection>
        <CompositeCollection x:Key="NoYesNull">
            <sys:String>No</sys:String>
            <sys:String>Yes</sys:String>
            <x:Static Member="sys:String.Empty"/>
        </CompositeCollection>
        <CompositeCollection x:Key="ModColorCodes">
            <SolidColorBrush>White</SolidColorBrush>
            <SolidColorBrush>Lime</SolidColorBrush>
            <SolidColorBrush>Cyan</SolidColorBrush>
            <SolidColorBrush>#E68080</SolidColorBrush>
            <SolidColorBrush>Magenta</SolidColorBrush>
            <SolidColorBrush>Yellow</SolidColorBrush>
        </CompositeCollection>
        <CompositeCollection x:Key="FalseTrue">
            <sys:Boolean>False</sys:Boolean>
            <sys:Boolean>True</sys:Boolean>
        </CompositeCollection>
        <CompositeCollection x:Key="RecipeItemKey_EquipmentSlot">
            <obj:RecipeItemKey>EquipmentSlot_MainHand</obj:RecipeItemKey>
            <obj:RecipeItemKey>EquipmentSlot_OffHand</obj:RecipeItemKey>
            <obj:RecipeItemKey>EquipmentSlot_Hands</obj:RecipeItemKey>
            <obj:RecipeItemKey>EquipmentSlot_Chest</obj:RecipeItemKey>
            <obj:RecipeItemKey>EquipmentSlot_Legs</obj:RecipeItemKey>
            <obj:RecipeItemKey>EquipmentSlot_Head</obj:RecipeItemKey>
            <obj:RecipeItemKey>EquipmentSlot_Feet</obj:RecipeItemKey>
            <obj:RecipeItemKey>EquipmentSlot_Ring</obj:RecipeItemKey>
            <obj:RecipeItemKey>EquipmentSlot_Necklace</obj:RecipeItemKey>
        </CompositeCollection>
        <CompositeCollection x:Key="RecipeItemKey_Rarity">
            <obj:RecipeItemKey>Rarity_Uncommon</obj:RecipeItemKey>
            <obj:RecipeItemKey>Rarity_Rare</obj:RecipeItemKey>
        </CompositeCollection>
        <CompositeCollection x:Key="RecipeItemKey_MinRarityUncommon">
            <obj:RecipeItemKey>MinRarity_Uncommon</obj:RecipeItemKey>
        </CompositeCollection>
        <CompositeCollection x:Key="RecipeItemKey_MinRarityExceptional">
            <obj:RecipeItemKey>MinRarity_Exceptional</obj:RecipeItemKey>
        </CompositeCollection>
        <CroppedBitmap x:Key="imgRedo" Source="pack://application:,,,/Resources/redo.png"/>
        <CroppedBitmap x:Key="imgUndo" Source="pack://application:,,,/Resources/undo.png"/>
        <CroppedBitmap x:Key="imgAttuned" Source="pack://application:,,,/Resources/Locked.png"/>
        <DataTemplate x:Key="AttributeLinkTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding FriendlyName}" TextWrapping="Wrap" Width="300" TextAlignment="Right"/>
                <TextBlock>:</TextBlock>
                <TextBlock Text="{Binding FriendlyEffect}" Width="150" Margin="5,0,0,0"/>
                <TextBlock>Score :</TextBlock>
                <TextBlock Text="{Binding FriendlyScore}" Width="150" Margin="5,0,0,0"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="SimpleEffectTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Description}" TextWrapping="Wrap" Width="300" TextAlignment="Right"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="AttributeLinkGearTemplate">
            <StackPanel Orientation="Horizontal">
                <Ellipse Fill="LightBlue" VerticalAlignment="Top" Width="5" Height="5" Margin="15,10,5,0"/>
                <ItemsControl ItemsSource="{Binding Link.IconFileNameList}" Margin="0,5,0,5">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Image Source="{Binding Converter={StaticResource convFileNameToBitmapImage}}" Width="32" Height="32"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
                <TextBlock Text="{Binding FriendlyNameAndEffect}" Foreground="#B19167" FontSize="22" FontFamily="Tahoma" TextWrapping="Wrap" Margin="25,5,0,0"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="SimpleEffectGearTemplate">
            <TextBlock Text="{Binding Description}" Foreground="#B19167" FontSize="22" FontFamily="Tahoma" TextWrapping="Wrap" Margin="10,0,10,0"/>
        </DataTemplate>
        <DataTemplate x:Key="LinkBackAbilityTemplate">
            <Grid>
                <Grid.Resources>
                    <DataTemplate x:Key="ItemTemplate">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Ability_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock Margin="0,0,5,0">,</TextBlock>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="ItemTemplateLast">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Ability_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                        </StackPanel>
                    </DataTemplate>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" TextAlignment="Right">Abilities:</TextBlock>
                <ItemsControl Grid.Column="1" ItemsSource="{Binding Value}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="LinkBackDirectedGoalTemplate">
            <Grid>
                <Grid.Resources>
                    <DataTemplate x:Key="ItemTemplate">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_DirectedGoal_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Label, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock Margin="0,0,5,0">,</TextBlock>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="ItemTemplateLast">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_DirectedGoal_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Label, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                        </StackPanel>
                    </DataTemplate>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" TextAlignment="Right">Goals:</TextBlock>
                <ItemsControl Grid.Column="1" ItemsSource="{Binding Value}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="LinkBackEffectTemplate">
            <Grid>
                <Grid.Resources>
                    <DataTemplate x:Key="ItemTemplate">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Effect_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock Margin="0,0,5,0">,</TextBlock>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="ItemTemplateLast">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Effect_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                        </StackPanel>
                    </DataTemplate>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" TextAlignment="Right">Effects:</TextBlock>
                <ItemsControl Grid.Column="1" ItemsSource="{Binding Value}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="LinkBackItemTemplate">
            <Grid>
                <Grid.Resources>
                    <DataTemplate x:Key="ItemTemplate">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Item_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock Margin="0,0,5,0">,</TextBlock>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="ItemTemplateLast">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Item_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                        </StackPanel>
                    </DataTemplate>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" TextAlignment="Right">Items:</TextBlock>
                <ItemsControl Grid.Column="1" ItemsSource="{Binding Value}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="LinkBackQuestTemplate">
            <Grid>
                <Grid.Resources>
                    <DataTemplate x:Key="ItemTemplate">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Quest_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock Margin="0,0,5,0">,</TextBlock>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="ItemTemplateLast">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Quest_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                        </StackPanel>
                    </DataTemplate>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" TextAlignment="Right">Quests:</TextBlock>
                <ItemsControl Grid.Column="1" ItemsSource="{Binding Value}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="LinkBackRecipeTemplate">
            <Grid>
                <Grid.Resources>
                    <DataTemplate x:Key="ItemTemplate">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Recipe_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock Margin="0,0,5,0">,</TextBlock>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="ItemTemplateLast">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Recipe_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                        </StackPanel>
                    </DataTemplate>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" TextAlignment="Right">Recipes:</TextBlock>
                <ItemsControl Grid.Column="1" ItemsSource="{Binding Value}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="LinkBackSkillTemplate">
            <Grid>
                <Grid.Resources>
                    <DataTemplate x:Key="ItemTemplate">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Skill_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock Margin="0,0,5,0">,</TextBlock>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="ItemTemplateLast">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Skill_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                        </StackPanel>
                    </DataTemplate>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" TextAlignment="Right">Skills:</TextBlock>
                <ItemsControl Grid.Column="1" ItemsSource="{Binding Value}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="LinkBackPowerTemplate">
            <Grid>
                <Grid.Resources>
                    <DataTemplate x:Key="ItemTemplate">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Power_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding ComposedName, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock Margin="0,0,5,0">,</TextBlock>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="ItemTemplateLast">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock TextWrapping="Wrap">
                                <Hyperlink x:Name="hyperlink_Power_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding ComposedName, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                        </StackPanel>
                    </DataTemplate>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" TextAlignment="Right">Mods:</TextBlock>
                <ItemsControl Grid.Column="1" ItemsSource="{Binding Value}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="AppearanceAbilityRequirementTemplate">
            <DataTemplate.Resources>
                <DataTemplate x:Key="ItemTemplateFirst">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock>Look like</TextBlock>
                        <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=AppearanceTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                    </StackPanel>
                </DataTemplate>
                <DataTemplate x:Key="ItemTemplate">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock>,</TextBlock>
                        <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=AppearanceTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                    </StackPanel>
                </DataTemplate>
                <DataTemplate x:Key="ItemTemplateLast">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Margin="5,0,0,0">or</TextBlock>
                        <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=AppearanceTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                    </StackPanel>
                </DataTemplate>
            </DataTemplate.Resources>
            <Grid>
                <StackPanel Visibility="{Binding AppearanceList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisibleCollapsed}, FallbackValue=Collapsed}" Orientation="Horizontal">
                    <TextBlock Text="Look like"/>
                    <TextBlock Text="{Binding AppearanceList[0], Converter={StaticResource convEnumToText}, ConverterParameter=AppearanceTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                </StackPanel>
                <ItemsControl ItemsSource="{Binding AppearanceList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}" Visibility="{Binding AppearanceList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedCollapsedVisible}, FallbackValue=Visible}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="CurHealthAbilityRequirementTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock>Health ≥</TextBlock>
                <TextBlock Text="{Binding Health}" Margin="5,0,0,0"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="DruidEventStateAbilityRequirementTemplate">
            <TextBlock>During druid event</TextBlock>
        </DataTemplate>
        <DataTemplate x:Key="EquippedItemKeywordAbilityRequirementTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock>Has</TextBlock>
                <TextBlock Text="{Binding Count}" Margin="5,0,0,0"/>
                <TextBlock Text="{Binding Keyword, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityKeywordTextMap, FallbackValue={x:Null}}" Margin="5,0,5,0"/>
                <TextBlock>items equipped</TextBlock>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="FullMoonAbilityRequirementTemplate">
            <TextBlock>Full Moon</TextBlock>
        </DataTemplate>
        <DataTemplate x:Key="GardenPlantMaxAbilityRequirementTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock>Maximum summoned:</TextBlock>
                <TextBlock Text="{Binding TypeTag, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityTypeTagTextMap, FallbackValue={x:Null}}" Margin="5,0,5,0"/>
                <TextBlock>x</TextBlock>
                <TextBlock Text="{Binding Count}"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="HasEffectKeywordAbilityRequirementTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock>Effect</TextBlock>
                <TextBlock Text="{Binding Effect, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityKeywordTextMap, FallbackValue={x:Null}}" Margin="5,0,5,0"/>
                <TextBlock>is active</TextBlock>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="HasInventorySpaceForAbilityRequirementTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock>Has inventory space for</TextBlock>
                <TextBlock TextWrapping="Wrap">
                    <Hyperlink x:Name="hyperlink_HasInventorySpaceForAbilityRequirement_Item" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                        <TextBlock Text="{Binding Item.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                    </Hyperlink>
                </TextBlock>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="InGraveyardAbilityRequirementTemplate">
            <TextBlock>In Graveyard</TextBlock>
        </DataTemplate>
        <DataTemplate x:Key="InHotspotAbilityRequirementTemplate">
            <TextBlock Text="{Binding Name}"/>
        </DataTemplate>
        <DataTemplate x:Key="InternalAbilityRequirementTemplate">
            <TextBlock Text="{Binding Keyword, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityItemKeywordTextMap, FallbackValue={x:Null}}" Margin="5,0,5,0"/>
        </DataTemplate>
        <DataTemplate x:Key="IsAdminAbilityRequirementTemplate">
            <TextBlock>Game Admin Only</TextBlock>
        </DataTemplate>
        <DataTemplate x:Key="IsHardcoreAbilityRequirementTemplate">
            <TextBlock>Be Hardcore</TextBlock>
        </DataTemplate>
        <DataTemplate x:Key="IsLongtimeAnimalAbilityRequirementTemplate">
            <TextBlock>Animal for a long time</TextBlock>
        </DataTemplate>
        <DataTemplate x:Key="IsLycanthropeAbilityRequirementTemplate">
            <TextBlock>Be a Lycanthrope</TextBlock>
        </DataTemplate>
        <DataTemplate x:Key="IsNotInCombatAbilityRequirementTemplate">
            <TextBlock>Out of combat</TextBlock>
        </DataTemplate>
        <DataTemplate x:Key="IsVegetarianAbilityRequirementTemplate">
            <TextBlock>Is Vegetarian</TextBlock>
        </DataTemplate>
        <DataTemplate x:Key="OrAbilityRequirementTemplate">
            <DataTemplate.Resources>
                <DataTemplate x:Key="ItemTemplateFirst">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Visibility="Hidden">or</TextBlock>
                        <ContentControl Content="{Binding}" ContentTemplateSelector="{StaticResource setTypeToTemplateName}" Margin="5,0,0,0"/>
                    </StackPanel>
                </DataTemplate>
                <DataTemplate x:Key="ItemTemplate">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock>or</TextBlock>
                        <ContentControl Content="{Binding}" ContentTemplateSelector="{StaticResource setTypeToTemplateName}" Margin="5,0,0,0"/>
                    </StackPanel>
                </DataTemplate>
            </DataTemplate.Resources>
            <StackPanel>
                <ItemsControl ItemsSource="{Binding OrList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}"/>
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <TextBlock>Error Message:</TextBlock>
                    <TextBlock Text="{Binding ErrorMsg}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="PetCountAbilityRequirementTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock>Max</TextBlock>
                <TextBlock Text="{Binding MaxCount}" Margin="5,0,5,0"/>
                <TextBlock Text="{Binding PetTypeTag, Converter={StaticResource convEnumToText}, ConverterParameter=RecipeKeywordTextMap, FallbackValue={x:Null}}"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="RaceAbilityRequirementTemplate">
            <DataTemplate.Resources>
                <DataTemplate x:Key="ItemTemplateFirst">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock>Be</TextBlock>
                        <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                    </StackPanel>
                </DataTemplate>
                <DataTemplate x:Key="ItemTemplate">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock>,</TextBlock>
                        <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                    </StackPanel>
                </DataTemplate>
                <DataTemplate x:Key="ItemTemplateLast">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Margin="5,0,0,0">or</TextBlock>
                        <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                    </StackPanel>
                </DataTemplate>
            </DataTemplate.Resources>
            <Grid>
                <StackPanel Visibility="{Binding AllowedRaceList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisibleCollapsed}, FallbackValue=Collapsed}" Orientation="Horizontal">
                    <TextBlock Text="Be"/>
                    <TextBlock Text="{Binding AllowedRaceList[0], Converter={StaticResource convEnumToText}, ConverterParameter=AppearanceTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                </StackPanel>
                <ItemsControl ItemsSource="{Binding AllowedRaceList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}" Visibility="{Binding AppearanceList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedCollapsedVisible}, FallbackValue=Visible}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="RecipeKnownAbilityRequirementTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock>Knows recipe</TextBlock>
                <TextBlock TextWrapping="Wrap" Margin="5,0,0,0">
                    <Hyperlink x:Name="hyperlink_RecipeKnownAbilityRequirement_RecipeKnown" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                        <TextBlock Text="{Binding RecipeKnown.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                    </Hyperlink>
                </TextBlock>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="RecipeCostTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Price}"/>
                <TextBlock Text="{Binding Currency, Converter={StaticResource convEnumToText}, ConverterParameter=RecipeCurrencyTextMap, FallbackValue={x:Null}}" Margin="5,0,0,0"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="ConsumedItemDirectTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Count}" Visibility="{Binding RawCount, Converter={StaticResource convNullToObject},ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Margin="0,0,5,0"/>
                <TextBlock TextWrapping="Wrap">
                    <Hyperlink x:Name="hyperlink_ConsumedItemDirect_Link" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                        <TextBlock Text="{Binding Link.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                    </Hyperlink>
                </TextBlock>
                <StackPanel Orientation="Horizontal" Visibility="{Binding RawConsumedChance, Converter={StaticResource convNullToObject},ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Margin="5,0,0,0">
                    <TextBlock>(</TextBlock>
                    <TextBlock Text="{Binding ConsumedChance}"/>
                    <TextBlock>% chance to be consumed)</TextBlock>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Visibility="{Binding RawChanceToStickInCorpse, Converter={StaticResource convNullToObject},ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Margin="5,0,0,0">
                    <TextBlock>(</TextBlock>
                    <TextBlock Text="{Binding ChanceToStickInCorpse}"/>
                    <TextBlock>% chance to stick in corpse)</TextBlock>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="ConsumedItemByKeywordTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Count}" Visibility="{Binding RawCount, Converter={StaticResource convNullToObject},ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Margin="0,0,5,0"/>
                <TextBlock Text="{Binding Keyword, Converter={StaticResource convEnumToText}, ConverterParameter=ConsumedItemsTextMap, FallbackValue={x:Null}}" Margin="5,0,0,0"/>
                <StackPanel Orientation="Horizontal" Visibility="{Binding RawConsumedChance, Converter={StaticResource convNullToObject},ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Margin="5,0,0,0">
                    <TextBlock>(</TextBlock>
                    <TextBlock Text="{Binding ConsumedChance}"/>
                    <TextBlock>% chance to be consumed)</TextBlock>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Visibility="{Binding RawChanceToStickInCorpse, Converter={StaticResource convNullToObject},ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Margin="5,0,0,0">
                    <TextBlock>(</TextBlock>
                    <TextBlock Text="{Binding ChanceToStickInCorpse}"/>
                    <TextBlock>% chance to stick in corpse)</TextBlock>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="ItemSimpleEffectTemplate">
            <TextBlock Text="{Binding Description}"/>
        </DataTemplate>
        <DataTemplate x:Key="ItemAttributeLinkTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Link.LabelRippedOfPercent}"/>
                <TextBlock>:</TextBlock>
                <TextBlock Text="{Binding FriendlyEffect}" Margin="5,0,0,0"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveTemplate">
            <WrapPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,5,0">
                    <TextBlock Text="{Binding Description}"/>
                    <StackPanel Visibility="{Binding RawNumber, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                        <TextBlock>(x</TextBlock>
                        <TextBlock Text="{Binding Number}"/>
                        <TextBlock>)</TextBlock>
                    </StackPanel>
                </StackPanel>
                <TextBlock TextWrapping="Wrap" FontStyle="Italic">
                    <TextBlock.Visibility>
                        <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                            <Binding Path="MinHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                        </MultiBinding>
                    </TextBlock.Visibility>
                    <TextBlock.Text>
                        <MultiBinding Converter="{StaticResource convMultiString}">
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter="(this step must be completed between "/>
                            <Binding Path="MinHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=" and "/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=")"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveKillTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Description}"/>
                <TextBlock Margin="5,0,0,0">(</TextBlock>
                <TextBlock Text="{Binding Target, Converter={StaticResource convEnumToText},ConverterParameter=QuestObjectiveKillTargetTextMap, FallbackValue={x:Null}}"/>
                <StackPanel Visibility="{Binding AbilityKeyword, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal">
                    <TextBlock>, using</TextBlock>
                    <TextBlock Text="{Binding AbilityKeyword}" Margin="5,0,0,0"/>
                </StackPanel>
                <TextBlock>, x</TextBlock>
                <TextBlock Text="{Binding Number}"/>
                <TextBlock>)</TextBlock>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveTipPlayerTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Description}"/>
                <TextBlock Margin="5,0,0,0">(Minimum amount:</TextBlock>
                <TextBlock Margin="5,0,5,0" Text="{Binding MinAmount}"/>
                <TextBlock>golds) x</TextBlock>
                <TextBlock Text="{Binding Number}"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveSpecialTemplate">
            <WrapPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,5,0">
                    <TextBlock Text="{Binding Description}"/>
                    <StackPanel Visibility="{Binding RawMinAmount, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                        <TextBlock>(min amount:</TextBlock>
                        <TextBlock Text="{Binding MinAmount}" Margin="5,0,0,0"/>
                        <TextBlock>)</TextBlock>
                    </StackPanel>
                    <StackPanel Visibility="{Binding RawMaxAmount, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                        <TextBlock>(max amount:</TextBlock>
                        <TextBlock Text="{Binding MaxAmount}" Margin="5,0,0,0"/>
                        <TextBlock>)</TextBlock>
                    </StackPanel>
                    <StackPanel Visibility="{Binding RawNumber, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                        <TextBlock>(x</TextBlock>
                        <TextBlock Text="{Binding Number}"/>
                        <TextBlock>)</TextBlock>
                    </StackPanel>
                </StackPanel>
                <TextBlock TextWrapping="Wrap" FontStyle="Italic">
                    <TextBlock.Visibility>
                        <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                            <Binding Path="MinHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                        </MultiBinding>
                    </TextBlock.Visibility>
                    <TextBlock.Text>
                        <MultiBinding Converter="{StaticResource convMultiString}">
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter="(this step must be completed between "/>
                            <Binding Path="MinHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=" and "/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=")"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveMultipleInteractionFlagsTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Description}"/>
                <StackPanel Visibility="{Binding RawNumber, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                    <TextBlock>(x</TextBlock>
                    <TextBlock Text="{Binding Number}"/>
                    <TextBlock>)</TextBlock>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveDeliverTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Description}" Margin="0,0,5,0"/>
                <TextBlock>(</TextBlock>
                <TextBlock Text="{Binding DeliverNpcName}" Margin="0,0,5,0"/>
                <TextBlock>in</TextBlock>
                <TextBlock Text="{Binding DeliverNpcArea, Converter={StaticResource convEnumToText}, ConverterParameter=MapAreaNameTextMap}" Margin="5,0,0,0"/>
                <TextBlock>)</TextBlock>
                <TextBlock TextWrapping="Wrap" VerticalAlignment="Center" Margin="10,0,0,0">
                    <Hyperlink x:Name="hyperlink_QuestObjectiveDeliver_QuestItem" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                        <TextBlock Text="{Binding QuestItem.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                    </Hyperlink>
                </TextBlock>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveItemTemplate">
            <WrapPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,5,0">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Top">
                        <Expander VerticalAlignment="Center" Width="0"/>
                        <TextBlock Text="{Binding Description}" VerticalAlignment="Center"/>
                    </StackPanel>
                    <StackPanel Visibility="{Binding QuestItem, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" VerticalAlignment="Top" Margin="10,0,5,0">
                        <Expander VerticalAlignment="Center" Width="0"/>
                        <TextBlock VerticalAlignment="Center">(</TextBlock>
                        <TextBlock TextWrapping="Wrap" VerticalAlignment="Center">
                            <Hyperlink x:Name="hyperlink_QuestObjectiveItem_QuestItem" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                <TextBlock Text="{Binding QuestItem.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                            </Hyperlink>
                        </TextBlock>
                        <TextBlock VerticalAlignment="Center">)</TextBlock>
                    </StackPanel>
                    <Expander Header="{Binding Target, Converter={StaticResource convEnumToText}, ConverterParameter=ItemKeywordTextMap}" Visibility="{Binding TargetItemList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" VerticalAlignment="Top" Margin="10,0,0,0">
                        <ItemsControl ItemsSource="{Binding TargetItemList, FallbackValue={x:Null}}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock TextWrapping="Wrap">
                                        <Hyperlink x:Name="hyperlink_Item_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                            <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </Hyperlink>
                                    </TextBlock>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Expander>
                    <StackPanel Visibility="{Binding RawNumber, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" VerticalAlignment="Top" Margin="5,0,0,0">
                        <Expander VerticalAlignment="Center" Width="0"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock>(x</TextBlock>
                            <TextBlock Text="{Binding Number}"/>
                            <TextBlock>)</TextBlock>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
                <TextBlock TextWrapping="Wrap" FontStyle="Italic" VerticalAlignment="Center">
                    <TextBlock.Visibility>
                        <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                            <Binding Path="MinHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                        </MultiBinding>
                    </TextBlock.Visibility>
                    <TextBlock.Text>
                        <MultiBinding Converter="{StaticResource convMultiString}">
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter="(this step must be completed between "/>
                            <Binding Path="MinHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=" and "/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=")"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveGuildGiveItemTemplate">
            <WrapPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,5,0">
                    <TextBlock Text="{Binding Description}" Margin="0,0,5,0"/>
                    <TextBlock>(</TextBlock>
                    <TextBlock TextWrapping="Wrap">
                        <Hyperlink x:Name="hyperlink_QuestObjectiveGuildGiveItem_QuestItem" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                            <TextBlock Text="{Binding QuestItem.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                        </Hyperlink>
                    </TextBlock>
                    <StackPanel Visibility="{Binding RawNumber, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                        <TextBlock>x</TextBlock>
                        <TextBlock Text="{Binding Number}"/>
                    </StackPanel>
                    <TextBlock>)</TextBlock>
                </StackPanel>
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveInteractionFlagTemplate">
            <WrapPanel>
                <TextBlock Text="{Binding Description}" Margin="0,0,5,0"/>
                <TextBlock TextWrapping="Wrap" FontStyle="Italic" VerticalAlignment="Center">
                    <TextBlock.Visibility>
                        <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                            <Binding Path="MinHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                        </MultiBinding>
                    </TextBlock.Visibility>
                    <TextBlock.Text>
                        <MultiBinding Converter="{StaticResource convMultiString}">
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter="(this step must be completed between "/>
                            <Binding Path="MinHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=" and "/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=")"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveGiveGiftTemplate">
            <WrapPanel>
                <TextBlock Text="{Binding Description}" Margin="0,0,5,0"/>
                <StackPanel Visibility="{Binding RawMinFavorReceived, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal">
                    <TextBlock>(Min favor received:</TextBlock>
                    <TextBlock Text="{Binding MinFavorReceived}" Margin="5,0,0,0"/>
                    <TextBlock>)</TextBlock>
                </StackPanel>
                <StackPanel Visibility="{Binding RawMaxFavorReceived, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal">
                    <TextBlock>(Max favor received:</TextBlock>
                    <TextBlock Text="{Binding MaxFavorReceived}" Margin="5,0,0,0"/>
                    <TextBlock>)</TextBlock>
                </StackPanel>
                <TextBlock TextWrapping="Wrap" FontStyle="Italic" VerticalAlignment="Center">
                    <TextBlock.Visibility>
                        <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                            <Binding Path="MinHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                        </MultiBinding>
                    </TextBlock.Visibility>
                    <TextBlock.Text>
                        <MultiBinding Converter="{StaticResource convMultiString}">
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter="(this step must be completed between "/>
                            <Binding Path="MinHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=" and "/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=")"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveUseRecipeTemplate">
            <WrapPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,5,0">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Top">
                        <Expander VerticalAlignment="Center" Width="0"/>
                        <TextBlock Text="{Binding Description}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <StackPanel Visibility="{Binding ConnectedSkill, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" VerticalAlignment="Center" Orientation="Horizontal">
                            <TextBlock>(Using</TextBlock>
                            <TextBlock TextWrapping="Wrap" Margin="5,0,0,0">
                                <Hyperlink x:Name="hyperlink_QuestObjectiveUseRecipe_ConnectedSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding ConnectedSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock>)</TextBlock>
                        </StackPanel>
                    </StackPanel>
                    <Expander Header="{Binding RecipeTarget, Converter={StaticResource convEnumToText}, ConverterParameter=RecipeKeywordTextMap}" Visibility="{Binding RecipeTargetList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" VerticalAlignment="Top" Margin="10,0,0,0">
                        <ItemsControl ItemsSource="{Binding RecipeTargetList,FallbackValue={x:Null}}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock TextWrapping="Wrap">
                                        <Hyperlink x:Name="hyperlink_Item_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                            <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </Hyperlink>
                                    </TextBlock>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Expander>
                    <Expander Header="{Binding ResultItemKeyword, Converter={StaticResource convEnumToText}, ConverterParameter=ItemKeywordTextMap}" Visibility="{Binding ResultItemList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" VerticalAlignment="Top" Margin="10,0,0,0">
                        <ItemsControl ItemsSource="{Binding ResultItemList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource setTypeToTemplateName}"/>
                    </Expander>
                    <StackPanel Visibility="{Binding RawNumber, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" VerticalAlignment="Top" Margin="5,0,0,0">
                        <Expander VerticalAlignment="Center" Width="0"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock>(x</TextBlock>
                            <TextBlock Text="{Binding Number}"/>
                            <TextBlock>)</TextBlock>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
                <TextBlock TextWrapping="Wrap" FontStyle="Italic" VerticalAlignment="Center">
                    <TextBlock.Visibility>
                        <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                            <Binding Path="MinHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                        </MultiBinding>
                    </TextBlock.Visibility>
                    <TextBlock.Text>
                        <MultiBinding Converter="{StaticResource convMultiString}">
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter="(this step must be completed between "/>
                            <Binding Path="MinHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=" and "/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=")"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveUseAbilityTemplate">
            <WrapPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,5,0">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Top">
                        <Expander VerticalAlignment="Center" Width="0"/>
                        <TextBlock Text="{Binding Description}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    </StackPanel>
                    <Expander Header="{Binding AbilityTarget, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityKeywordTextMap}" Visibility="{Binding AbilityTargetList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" VerticalAlignment="Top" Margin="10,0,0,0">
                        <ItemsControl ItemsSource="{Binding AbilityTargetList,FallbackValue={x:Null}}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock TextWrapping="Wrap">
                                        <Hyperlink x:Name="hyperlink_Item_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                            <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </Hyperlink>
                                    </TextBlock>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Expander>
                    <StackPanel Visibility="{Binding RawNumber, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" VerticalAlignment="Top" Margin="5,0,0,0">
                        <Expander VerticalAlignment="Center" Width="0"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock>(x</TextBlock>
                            <TextBlock Text="{Binding Number}"/>
                            <TextBlock>)</TextBlock>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
                <TextBlock TextWrapping="Wrap" FontStyle="Italic" VerticalAlignment="Center">
                    <TextBlock.Visibility>
                        <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                            <Binding Path="MinHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                        </MultiBinding>
                    </TextBlock.Visibility>
                    <TextBlock.Text>
                        <MultiBinding Converter="{StaticResource convMultiString}">
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter="(this step must be completed between "/>
                            <Binding Path="MinHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=" and "/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=")"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="QuestObjectiveAnatomyTemplate">
            <WrapPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,5,0">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Top">
                        <Expander VerticalAlignment="Center" Width="0"/>
                        <TextBlock Text="{Binding Description}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <StackPanel Visibility="{Binding ConnectedSkill, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" VerticalAlignment="Center" Orientation="Horizontal">
                            <TextBlock>(Creatures of</TextBlock>
                            <TextBlock TextWrapping="Wrap" Margin="5,0,0,0">
                                <Hyperlink x:Name="hyperlink_QuestObjectiveAnatomy_ConnectedSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                    <TextBlock Text="{Binding ConnectedSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </Hyperlink>
                            </TextBlock>
                            <TextBlock>)</TextBlock>
                        </StackPanel>
                    </StackPanel>
                    <StackPanel Visibility="{Binding RawNumber, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" VerticalAlignment="Top" Margin="5,0,0,0">
                        <Expander VerticalAlignment="Center" Width="0"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock>(x</TextBlock>
                            <TextBlock Text="{Binding Number}"/>
                            <TextBlock>)</TextBlock>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
                <TextBlock TextWrapping="Wrap" FontStyle="Italic" VerticalAlignment="Center">
                    <TextBlock.Visibility>
                        <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                            <Binding Path="MinHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullToObject}" ConverterParameter="{StaticResource FalseTrue}" FallbackValue="False"/>
                        </MultiBinding>
                    </TextBlock.Visibility>
                    <TextBlock.Text>
                        <MultiBinding Converter="{StaticResource convMultiString}">
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter="(this step must be completed between "/>
                            <Binding Path="MinHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=" and "/>
                            <Binding Path="MaxHour" Converter="{StaticResource convNullableIntToTime}"/>
                            <Binding Converter="{StaticResource convConstant}" ConverterParameter=")"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="RecipeItemTemplate">
            <StackPanel Orientation="Horizontal">
                <Image Visibility="{Binding AttuneToCrafter, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Source="{StaticResource imgAttuned}" ToolTip="This item is attuned to the crafter" Width="6" Height="8" Margin="0,0,5,0"/>
                <Grid>
                    <StackPanel Visibility="{Binding Item, Converter={StaticResource convNullToObject},ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal">
                        <TextBlock TextWrapping="Wrap">
                        <Hyperlink x:Name="hyperlink_RecipeItem_Item" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                            <TextBlock Text="{Binding Item.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                        </Hyperlink>
                    </TextBlock>
                        <StackPanel Visibility="{Binding RawStackSize, Converter={StaticResource convNullToObject},ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                            <TextBlock>x</TextBlock>
                            <TextBlock Text="{Binding StackSize, FallbackValue={x:Null}}"/>
                        </StackPanel>
                        <StackPanel Visibility="{Binding RawChanceToConsume, Converter={StaticResource convNullToObject},ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                            <TextBlock>(</TextBlock>
                            <TextBlock Text="{Binding ChanceToConsume, Converter={StaticResource convDouble}, ConverterParameter=%, FallbackValue={x:Null}}" Margin="0,0,5,0"/>
                            <TextBlock>chance to consume)</TextBlock>
                        </StackPanel>
                        <StackPanel Visibility="{Binding RawDurabilityConsumed, Converter={StaticResource convNullToObject},ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                            <TextBlock>(</TextBlock>
                            <TextBlock Text="{Binding DurabilityConsumed, Converter={StaticResource convDouble}, ConverterParameter=%, FallbackValue={x:Null}}" Margin="0,0,5,0"/>
                            <TextBlock>durability consumed)</TextBlock>
                        </StackPanel>
                    </StackPanel>
                    <Grid Visibility="{Binding Item, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource VisibleCollapsed}, FallbackValue=Visible}">
                        <StackPanel Orientation="Horizontal">
                            <StackPanel.Visibility>
                                <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                                    <Binding Path="ItemKey" Converter="{StaticResource convIsEnumInSet}" ConverterParameter="{StaticResource RecipeItemKey_EquipmentSlot}" FallbackValue="False"/>
                                </MultiBinding>
                            </StackPanel.Visibility>
                            <TextBlock>Any</TextBlock>
                            <TextBlock Text="{Binding ItemKey, Converter={StaticResource convEnumToText}, ConverterParameter=RecipeItemKeyTextMap, FallbackValue={x:Null}}" Margin="5,0,0,0"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <StackPanel.Visibility>
                                <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                                    <Binding Path="ItemKey" Converter="{StaticResource convIsEnumInSet}" ConverterParameter="{StaticResource RecipeItemKey_Rarity}" FallbackValue="False"/>
                                </MultiBinding>
                            </StackPanel.Visibility>
                            <TextBlock>Any</TextBlock>
                            <TextBlock Text="{Binding ItemKey, Converter={StaticResource convEnumToText}, ConverterParameter=RecipeItemKeyTextMap, FallbackValue={x:Null}}" Margin="5,0,5,0"/>
                            <TextBlock>item</TextBlock>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <StackPanel.Visibility>
                                <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                                    <Binding Path="ItemKey" Converter="{StaticResource convIsEnumInSet}" ConverterParameter="{StaticResource RecipeItemKey_MinRarityUncommon}" FallbackValue="False"/>
                                </MultiBinding>
                            </StackPanel.Visibility>
                            <TextBlock>Any magical item</TextBlock>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <StackPanel.Visibility>
                                <MultiBinding Converter="{StaticResource convAnd}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                                    <Binding Path="ItemKey" Converter="{StaticResource convIsEnumInSet}" ConverterParameter="{StaticResource RecipeItemKey_MinRarityExceptional}" FallbackValue="False"/>
                                </MultiBinding>
                            </StackPanel.Visibility>
                            <TextBlock>Any exceptional item or better</TextBlock>
                        </StackPanel>
                        <Grid>
                            <Grid.Visibility>
                                <MultiBinding Converter="{StaticResource convOr}" ConverterParameter="{StaticResource VisibleCollapsed}" FallbackValue="Visible">
                                    <Binding Path="ItemKey" Converter="{StaticResource convIsEnumInSet}" ConverterParameter="{StaticResource RecipeItemKey_EquipmentSlot}" FallbackValue="False"/>
                                    <Binding Path="ItemKey" Converter="{StaticResource convIsEnumInSet}" ConverterParameter="{StaticResource RecipeItemKey_Rarity}" FallbackValue="False"/>
                                    <Binding Path="ItemKey" Converter="{StaticResource convIsEnumInSet}" ConverterParameter="{StaticResource RecipeItemKey_MinRarityUncommon}" FallbackValue="False"/>
                                    <Binding Path="ItemKey" Converter="{StaticResource convIsEnumInSet}" ConverterParameter="{StaticResource RecipeItemKey_MinRarityExceptional}" FallbackValue="False"/>
                                </MultiBinding>
                            </Grid.Visibility>
                            <StackPanel Orientation="Horizontal">
                                <StackPanel.Visibility>
                                    <MultiBinding Converter="{StaticResource convOr}" ConverterParameter="{StaticResource CollapsedVisible}" FallbackValue="Collapsed">
                                        <Binding Path="MatchingKeyItemList.Count" Converter="{StaticResource convIntThreshold}" ConverterParameter="10" FallbackValue="False"/>
                                    </MultiBinding>
                                </StackPanel.Visibility>
                                <TextBlock>Any</TextBlock>
                                <TextBlock Text="{Binding ItemKey, Converter={StaticResource convEnumToText}, ConverterParameter=RecipeItemKeyTextMap, FallbackValue={x:Null}}" Margin="5,0,0,0"/>
                            </StackPanel>
                            <Grid>
                                <Grid.Visibility>
                                    <MultiBinding Converter="{StaticResource convOr}" ConverterParameter="{StaticResource VisibleCollapsed}" FallbackValue="Visible">
                                        <Binding Path="MatchingKeyItemList.Count" Converter="{StaticResource convIntThreshold}" ConverterParameter="10" FallbackValue="False"/>
                                    </MultiBinding>
                                </Grid.Visibility>
                                <Grid.Resources>
                                    <DataTemplate x:Key="ItemTemplateFirst">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Margin="0,0,5,0">One of</TextBlock>
                                            <TextBlock TextWrapping="Wrap">
                                            <Hyperlink x:Name="hyperlink_Item_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                            </Hyperlink>
                                        </TextBlock>
                                            <TextBlock Margin="0,0,5,0">,</TextBlock>
                                        </StackPanel>
                                    </DataTemplate>
                                    <DataTemplate x:Key="ItemTemplate">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock TextWrapping="Wrap">
                                            <Hyperlink x:Name="hyperlink_Item_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                            </Hyperlink>
                                        </TextBlock>
                                            <TextBlock Margin="0,0,5,0">,</TextBlock>
                                        </StackPanel>
                                    </DataTemplate>
                                    <DataTemplate x:Key="ItemTemplateLast">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock TextWrapping="Wrap">
                                            <Hyperlink x:Name="hyperlink_Item_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                            </Hyperlink>
                                        </TextBlock>
                                        </StackPanel>
                                    </DataTemplate>
                                </Grid.Resources>
                                <ItemsControl ItemsSource="{Binding MatchingKeyItemList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>
            </StackPanel>
        </DataTemplate>
        <ControlTemplate x:Key="XpTableToggleButton" TargetType="ToggleButton">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="20" />
                </Grid.ColumnDefinitions>
                <Border x:Name="Border" Grid.ColumnSpan="2" CornerRadius="2" Background="White" BorderBrush="Black" BorderThickness="1"/>
                <Border Grid.Column="0" CornerRadius="2,0,0,2" Margin="1" Background="White" BorderBrush="Black" BorderThickness="0,0,1,0"/>
                <Path x:Name="Arrow" Grid.Column="1" Fill="Gray" HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 0 0 L 4 4 L 8 0 Z"/>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="ToggleButton.IsMouseOver" Value="true">
                    <Setter TargetName="Border" Property="Background" Value="DarkGray" />
                </Trigger>
                <Trigger Property="ToggleButton.IsChecked" Value="true">
                    <Setter TargetName="Border" Property="Background" Value="LightGray" />
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter TargetName="Border" Property="Background" Value="LightGray" />
                    <Setter TargetName="Border" Property="BorderBrush" Value="DarkGray" />
                    <Setter Property="Foreground" Value="LightGray"/>
                    <Setter TargetName="Arrow" Property="Fill" Value="Gray" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </Window.Resources>
    <Window.CommandBindings>
        <CommandBinding Command="{StaticResource StartApplicationCommand}" Executed="OnStartApplication"/>
        <CommandBinding Command="{StaticResource ClearVersionListCommand}" Executed="OnClearVersionList"/>
        <CommandBinding Command="{StaticResource CancelCommand}" Executed="OnCancel"/>
        <CommandBinding Command="{StaticResource AddPowerCommand}" Executed="OnAddPower"/>
        <CommandBinding Command="{StaticResource RemovePowerCommand}" Executed="OnRemovePower"/>
        <CommandBinding Command="{StaticResource LoadBuildCommand}" Executed="OnLoadBuild"/>
        <CommandBinding Command="{StaticResource SaveBuildCommand}" Executed="OnSaveBuild"/>
        <CommandBinding Command="{StaticResource CopyBuildCommand}" Executed="OnCopyBuild"/>
        <CommandBinding Command="{StaticResource CrunchCommand}" Executed="OnCrunch"/>
        <CommandBinding Command="{StaticResource OpenProfileFolderCommand}" Executed="OnOpenProfileFolder"/>
        <CommandBinding Command="{StaticResource BackwardCommand}" Executed="OnBackward"/>
        <CommandBinding Command="{StaticResource ForwardCommand}" Executed="OnForward"/>
    </Window.CommandBindings>
    <Grid>
        <StackPanel Visibility="{Binding IsAtStartup, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource HiddenVisible}, FallbackValue=Visible}" HorizontalAlignment="Center" VerticalAlignment="Center" MinWidth="350">
            <Border BorderBrush="Green" BorderThickness="2">
                <StackPanel Margin="20,20,20,20">
                    <RadioButton IsChecked="{Binding LocateLastestVersion}" Checked="OnLocateLatestVersion" Content="Locate and download the latest version of the game"/>
                    <StackPanel IsEnabled="{Binding IsVersionAvailableInCache}" Margin="0,10,0,0">
                        <RadioButton IsChecked="{Binding UseSpecificVersion}" Checked="OnUseSpecificVersion" Content="Use this version:">
                            <RadioButton.Style>
                                <Style TargetType="{x:Type RadioButton}">
                                    <Style.Triggers>
                                        <Trigger Property="IsEnabled" Value="False">
                                            <Setter Property="Foreground" Value="{StaticResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </RadioButton.Style>
                        </RadioButton>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                            <ComboBox ItemsSource="{Binding VersionList}" SelectedIndex="{Binding SelectedVersionIndex}" VerticalAlignment="Center" Width="50" Margin="0,0,0,0"/>
                            <Button Command="{StaticResource ClearVersionListCommand}" VerticalAlignment="Stretch" Width="120" Margin="10,0,0,0">Clear List</Button>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>
            <Button Command="{StaticResource StartApplicationCommand}" HorizontalAlignment="Center" Width="120" Margin="0,40,0,0">Start</Button>
        </StackPanel>
        <StackPanel Visibility="{Binding HasDownloadStarted, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource HiddenVisible}, FallbackValue=Visible}" HorizontalAlignment="Center" VerticalAlignment="Center" MinWidth="350">
            <Border BorderBrush="Orange" BorderThickness="2">
                <StackPanel Margin="20,20,20,20">
                    <Grid>
                        <StackPanel Visibility="{Binding IsLocating, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource HiddenVisible}, FallbackValue=Visible}">
                            <TextBlock>Locating latest version of the game...</TextBlock>
                            <ProgressBar IsIndeterminate="True" Height="8" Margin="0,10,0,0"/>
                        </StackPanel>
                        <Grid Visibility="{Binding IsLocating, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource VisibleHidden}, FallbackValue=Hidden}">
                            <StackPanel Visibility="{Binding IsDownloading, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource HiddenVisible}, FallbackValue=Visible}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock>Downloading version</TextBlock>
                                    <TextBlock Text="{Binding DownloadedVersion}" Margin="5,0,5,0"/>
                                    <TextBlock>of the game...</TextBlock>
                                </StackPanel>
                                <ProgressBar Minimum="0" Maximum="1" Value="{Binding DownloadProgress, FallbackValue=0}" IsEnabled="{Binding IsOperationStarted}" Height="8" Margin="0,10,0,0"/>
                            </StackPanel>
                            <StackPanel Visibility="{Binding IsDownloading, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource VisibleHidden}, FallbackValue=Hidden}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock>Version</TextBlock>
                                    <TextBlock Text="{Binding DownloadedVersion}" Margin="5,0,5,0"/>
                                    <TextBlock>loaded from cache</TextBlock>
                                </StackPanel>
                                <ProgressBar Minimum="0" Maximum="1" Value="{Binding DownloadProgress, FallbackValue=0}" IsEnabled="{Binding IsOperationStarted}" Height="8" Margin="0,10,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Grid>
                    <Grid Visibility="{Binding IsJsonLoading, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource HiddenVisible}, FallbackValue=Hidden}" Margin="0,20,0,0">
                        <StackPanel Visibility="{Binding IsLoadingIcons, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource VisibleHidden}, FallbackValue=Visible}">
                            <TextBlock>Parsing files...</TextBlock>
                            <ProgressBar Minimum="0" Maximum="1" Value="{Binding FileLoadProgress, FallbackValue=0}" IsEnabled="{Binding IsOperationStarted}" Height="8" Margin="0,10,0,0"/>
                        </StackPanel>
                        <StackPanel Visibility="{Binding IsLoadingIcons, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource HiddenVisible}, FallbackValue=Hidden}">
                            <TextBlock>Loading icons...</TextBlock>
                            <ProgressBar Minimum="0" Maximum="1" Value="{Binding IconLoadProgress, FallbackValue=0}" IsEnabled="{Binding IsOperationStarted}" Height="8" Margin="0,10,0,0"/>
                        </StackPanel>
                    </Grid>
                    <Button Command="{StaticResource CancelCommand}" Visibility="{Binding IsOperationCanceled, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource VisibleHidden}, FallbackValue=Visible}" HorizontalAlignment="Center" Width="120" Margin="0,40,0,0">Cancel</Button>
                </StackPanel>
            </Border>
        </StackPanel>
        <TabControl Visibility="{Binding IsJsonLoaded, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource HiddenVisible}, FallbackValue=Hidden}">
            <TabItem Header="Warnings">
                <DockPanel>
                    <Border DockPanel.Dock="Top" BorderThickness="0" BorderBrush="{x:Null}">
                        <TextBlock TextAlignment="Center" Margin="0,5,0,5">Downloaded content copyright © 2017, Elder Game, LLC</TextBlock>
                    </Border>
                    <Separator DockPanel.Dock="Top"/>
                    <TextBox x:Name="textWarnings" IsReadOnly="True" VerticalScrollBarVisibility="Visible" BorderBrush="{x:Null}" BorderThickness="0" Margin="10,10,10,10"/>
                </DockPanel>
            </TabItem>
            <TabItem Header="Build Planer">
                <TabItem.Resources>
                    <DataTemplate x:Key="PowerSkillTemplate">
                        <TextBlock Text="{Binding Converter={StaticResource convFriendlyName}}"/>
                    </DataTemplate>
                </TabItem.Resources>
                <DockPanel Margin="10,10,10,10">
                    <DockPanel DockPanel.Dock="Top" LastChildFill="False">
                        <GroupBox DockPanel.Dock="Left" VerticalAlignment="Center" Header="Skill Selection">
                            <Grid Margin="5,5,5,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Column="0" Grid.Row="0" TextAlignment="Right" VerticalAlignment="Center">First Skill:</TextBlock>
                                <ComboBox Grid.Column="1" Grid.Row="0" x:Name="comboFirstSkill" DockPanel.Dock="Left" SelectedIndex="{Binding SelectedFirstSkill}" ItemsSource="{Binding CombatSkillList}" ItemTemplate="{StaticResource PowerSkillTemplate}" HorizontalAlignment="Left" VerticalAlignment="Center" SelectionChanged="OnRefreshBuildPlaner" Width="150" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="1" TextAlignment="Right" VerticalAlignment="Center" Margin="0,10,0,0">Max Level:</TextBlock>
                                <TextBox Grid.Column="1" Grid.Row="1" Text="{Binding MaxLevelFirstSkill, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Left" VerticalAlignment="Center" Width="50" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="0" TextAlignment="Right" VerticalAlignment="Center" Margin="10,0,0,0">Second Skill:</TextBlock>
                                <ComboBox Grid.Column="3" Grid.Row="0" x:Name="comboSecondSkill" DockPanel.Dock="Left" SelectedIndex="{Binding SelectedSecondSkill}" ItemsSource="{Binding CombatSkillList}" ItemTemplate="{StaticResource PowerSkillTemplate}" HorizontalAlignment="Left" VerticalAlignment="Center" SelectionChanged="OnRefreshBuildPlaner" Width="150" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="1" TextAlignment="Right" VerticalAlignment="Center" Margin="10,10,0,0">Max Level:</TextBlock>
                                <TextBox Grid.Column="3" Grid.Row="1" Text="{Binding MaxLevelSecondSkill, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Left" VerticalAlignment="Center" Width="50" Margin="5,10,0,0"/>
                                <Button Grid.Row="0" Width="1" Visibility="Hidden"/>
                                <CheckBox Grid.Row="1" Width="1" Visibility="Hidden"/>
                            </Grid>
                        </GroupBox>
                        <GroupBox DockPanel.Dock="Left" VerticalAlignment="Center" Header="Gear Selection" Margin="10,0,0,0">
                            <Grid Margin="5,5,5,5">
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <DockPanel Grid.Row="0">
                                    <TextBlock DockPanel.Dock="Left" VerticalAlignment="Center">Profile:</TextBlock>
                                    <Button DockPanel.Dock="Right" Command="{StaticResource OpenProfileFolderCommand}" VerticalAlignment="Center" Width="120" Height="24" Margin="10,0,0,0">Open Profile Folder</Button>
                                    <ComboBox ItemsSource="{Binding WeightProfileList}" SelectedIndex="{Binding WeightProfileIndex}" SelectionChanged="OnProfileSelected" VerticalAlignment="Center" MinWidth="200" Margin="5,0,0,0"/>
                                </DockPanel>
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                                    <CheckBox IsChecked="{Binding IgnoreUnobtainable}" Checked="OnIgnoreUnobtainableCheckChanged" Unchecked="OnIgnoreUnobtainableCheckChanged" VerticalAlignment="Center" Margin="10,0,0,0">Ignore unobtainable</CheckBox>
                                    <CheckBox IsChecked="{Binding IgnoreNoAttribute}" Checked="OnIgnoreNoAttributeCheckChanged" Unchecked="OnIgnoreNoAttributeCheckChanged" VerticalAlignment="Center" Margin="10,0,0,0">Ignore items with no match</CheckBox>
                                </StackPanel>
                            </Grid>
                        </GroupBox>
                        <Button DockPanel.Dock="Right" Content="Copy to Clipboard" Command="{StaticResource CopyBuildCommand}" VerticalAlignment="Top" Width="120" Height="24" Margin="0,22,10,0"/>
                        <Button DockPanel.Dock="Right" Content="Save profile..." Command="{StaticResource SaveBuildCommand}" VerticalAlignment="Top" Width="120" Height="24" Margin="0,22,10,0"/>
                        <Button DockPanel.Dock="Right" Content="Load profile..." Command="{StaticResource LoadBuildCommand}" VerticalAlignment="Top" Width="120" Height="24" Margin="0,22,10,0"/>
                    </DockPanel>
                    <TabControl Margin="0,10,0,0">
                        <TabControl.Resources>
                            <DataTemplate x:Key="GearNameTemplate">
                                <TextBlock Text="{Binding Name}"/>
                            </DataTemplate>
                            <DataTemplate x:Key="PlanerHeaderTemplate">
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="{Binding IconFileName, Converter={StaticResource convFileNameToBitmapImage}}"/>
                                    <TextBlock Text="{Binding SlotName, Converter={StaticResource convFriendlyName}}" VerticalAlignment="Center" Margin="10,0,20,0"/>
                                </StackPanel>
                            </DataTemplate>
                            <DataTemplate x:Key="PlanerTemplate">
                                <Grid Margin="10,10,10,10">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="PowerNameTemplate">
                                            <TextBlock Text="{Binding Name}"/>
                                        </DataTemplate>
                                        <DataTemplate x:Key="FullPowerTemplate">
                                            <DockPanel>
                                                <Ellipse DockPanel.Dock="Left" Fill="LightBlue" VerticalAlignment="Top" Width="5" Height="5" Margin="9,12,7,0"/>
                                                <ItemsControl DockPanel.Dock="Left" ItemsSource="{Binding IconFileNameList}" VerticalAlignment="Top" Margin="0,5,0,5">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Image Source="{Binding Converter={StaticResource convFileNameToBitmapImage}}" Width="32" Height="32"/>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <VirtualizingStackPanel Orientation="Horizontal"/>
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>
                                                </ItemsControl>
                                                <TextBlock Text="{Binding Name}" Foreground="Lime" FontSize="22" FontFamily="Tahoma" TextWrapping="Wrap" VerticalAlignment="Top" Margin="30,3,0,0"/>
                                            </DockPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="548"/>
                                        <ColumnDefinition Width="250"/>
                                    </Grid.ColumnDefinitions>
                                    <DockPanel Grid.Column="0" Margin="0,0,5,0">
                                        <Expander DockPanel.Dock="Bottom" Header="Other mods" Margin="0,10,0,0">
                                            <TabControl Margin="0,10,0,0">
                                                <TabItem Header="Generic">
                                                    <Grid>
                                                        <ListBox ItemsSource="{Binding AvailablePowerList3}" ItemTemplate="{StaticResource PowerNameTemplate}" SelectedIndex="{Binding AvailablePowerIndex3}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                                        <ListBox Visibility="Hidden" ItemsSource="{Binding AvailablePowerList4}" ItemTemplate="{StaticResource PowerNameTemplate}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                                        <ListBox Visibility="Hidden" ItemsSource="{Binding AvailablePowerList5}" ItemTemplate="{StaticResource PowerNameTemplate}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                                    </Grid>
                                                </TabItem>
                                                <TabItem Header="Endurance">
                                                    <Grid>
                                                        <ListBox Visibility="Hidden" ItemsSource="{Binding AvailablePowerList3}" ItemTemplate="{StaticResource PowerNameTemplate}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                                        <ListBox ItemsSource="{Binding AvailablePowerList4}" ItemTemplate="{StaticResource PowerNameTemplate}" SelectedIndex="{Binding AvailablePowerIndex4}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                                        <ListBox Visibility="Hidden" ItemsSource="{Binding AvailablePowerList5}" ItemTemplate="{StaticResource PowerNameTemplate}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                                    </Grid>
                                                </TabItem>
                                                <TabItem Header="Shamanic Infusion">
                                                    <Grid>
                                                        <ListBox Visibility="Hidden" ItemsSource="{Binding AvailablePowerList3}" ItemTemplate="{StaticResource PowerNameTemplate}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                                        <ListBox Visibility="Hidden" ItemsSource="{Binding AvailablePowerList4}" ItemTemplate="{StaticResource PowerNameTemplate}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                                        <ListBox ItemsSource="{Binding AvailablePowerList5}" ItemTemplate="{StaticResource PowerNameTemplate}" SelectedIndex="{Binding AvailablePowerIndex5}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                                    </Grid>
                                                </TabItem>
                                            </TabControl>
                                        </Expander>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                            </Grid.RowDefinitions>
                                            <StackPanel Grid.Row="0" Visibility="{Binding SelectedIndex, ElementName=comboFirstSkill, Converter={StaticResource convIndexToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock FontWeight="Bold" Text="{Binding SelectedItem, ElementName=comboFirstSkill, Converter={StaticResource convFriendlyName}}"/>
                                                    <TextBlock FontWeight="Bold" Margin="5,0,0,0">mods</TextBlock>
                                                </StackPanel>
                                                <ListBox ItemsSource="{Binding AvailablePowerList1}" ItemTemplate="{StaticResource PowerNameTemplate}" SelectedIndex="{Binding AvailablePowerIndex1}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                            </StackPanel>
                                            <StackPanel Grid.Row="1" Visibility="{Binding SelectedIndex, ElementName=comboSecondSkill, Converter={StaticResource convIndexToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock FontWeight="Bold" Text="{Binding SelectedItem, ElementName=comboSecondSkill, Converter={StaticResource convFriendlyName}}"/>
                                                    <TextBlock FontWeight="Bold" Margin="5,0,0,0">mods</TextBlock>
                                                </StackPanel>
                                                <ListBox ItemsSource="{Binding AvailablePowerList2}" ItemTemplate="{StaticResource PowerNameTemplate}" SelectedIndex="{Binding AvailablePowerIndex2}" BorderBrush="{x:Null}" BorderThickness="0"/>
                                            </StackPanel>
                                        </Grid>
                                    </DockPanel>
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                        <Button Content="Add -&gt;" Command="{StaticResource AddPowerCommand}" Margin="0,0,0,5"/>
                                        <Button Content="&lt;- Remove" Command="{StaticResource RemovePowerCommand}" Margin="0,5,0,0"/>
                                    </StackPanel>
                                    <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Visible" Margin="10,0,0,0">
                                        <StackPanel Background="Black">
                                            <DockPanel Margin="10,10,10,0">
                                                <Image DockPanel.Dock="Left" Source="{Binding SelectedGearIcon, Converter={StaticResource convFileNameToBitmapImage}}" Width="48" Height="48" VerticalAlignment="Top"/>
                                                <StackPanel Margin="10,2,5,0">
                                                    <TextBlock Text="{Binding SelectedGearName, Converter={StaticResource convFriendlyName}}" Foreground="{Binding ColorIndex, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource ModColorCodes}, FallbackValue=White}" FontSize="28" FontWeight="Bold" FontFamily="Times New Roman" TextWrapping="Wrap" VerticalAlignment="Top"/>
                                                    <TextBlock Text="{Binding SelectedGearDescription}" Foreground="#B19167" FontSize="22" FontFamily="Tahoma" TextWrapping="Wrap" Margin="1,5,0,0"/>
                                                </StackPanel>
                                            </DockPanel>
                                            <ItemsControl ItemsSource="{Binding SelectedGearEffectDescriptionList}" ItemTemplateSelector="{StaticResource selItemEffectGear}" Margin="0,10,0,0"/>
                                            <StackPanel Margin="0,10,0,10">
                                                <ListBox ItemsSource="{Binding SelectedPowerList1}" ItemTemplate="{StaticResource FullPowerTemplate}" SelectedIndex="{Binding SelectedPowerIndex1}" BorderBrush="{x:Null}" BorderThickness="0" Background="Black" HorizontalContentAlignment="Stretch" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                    <ListBox.ItemContainerStyle>
                                                        <Style TargetType="ListBoxItem">
                                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                        </Style>
                                                    </ListBox.ItemContainerStyle>
                                                </ListBox>
                                                <ListBox ItemsSource="{Binding SelectedPowerList2}" ItemTemplate="{StaticResource FullPowerTemplate}" SelectedIndex="{Binding SelectedPowerIndex2}" BorderBrush="{x:Null}" BorderThickness="0" Background="Black" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                    <ListBox.ItemContainerStyle>
                                                        <Style TargetType="ListBoxItem">
                                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                        </Style>
                                                    </ListBox.ItemContainerStyle>
                                                </ListBox>
                                                <ListBox ItemsSource="{Binding SelectedPowerList3}" ItemTemplate="{StaticResource FullPowerTemplate}" SelectedIndex="{Binding SelectedPowerIndex3}" BorderBrush="{x:Null}" BorderThickness="0" Background="Black" HorizontalAlignment="Left" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                    <ListBox.ItemContainerStyle>
                                                        <Style TargetType="ListBoxItem">
                                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                        </Style>
                                                    </ListBox.ItemContainerStyle>
                                                </ListBox>
                                                <ListBox ItemsSource="{Binding SelectedPowerList4}" ItemTemplate="{StaticResource FullPowerTemplate}" SelectedIndex="{Binding SelectedPowerIndex4}" BorderBrush="{x:Null}" BorderThickness="0" Background="Black" HorizontalAlignment="Left" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                    <ListBox.ItemContainerStyle>
                                                        <Style TargetType="ListBoxItem">
                                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                        </Style>
                                                    </ListBox.ItemContainerStyle>
                                                </ListBox>
                                                <ListBox ItemsSource="{Binding SelectedPowerList5}" ItemTemplate="{StaticResource FullPowerTemplate}" SelectedIndex="{Binding SelectedPowerIndex5}" BorderBrush="{x:Null}" BorderThickness="0" Background="Black" HorizontalAlignment="Left" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                    <ListBox.ItemContainerStyle>
                                                        <Style TargetType="ListBoxItem">
                                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                        </Style>
                                                    </ListBox.ItemContainerStyle>
                                                </ListBox>
                                            </StackPanel>
                                        </StackPanel>
                                    </ScrollViewer>
                                    <ListBox Grid.Column="3" x:Name="listGear" ItemsSource="{Binding SortedGearList}" ItemTemplate="{StaticResource GearNameTemplate}" SelectedIndex="{Binding SelectedGearIndex}" Margin="10,0,0,0"/>
                                </Grid>
                            </DataTemplate>
                        </TabControl.Resources>
                        <TabItem HeaderTemplate="{StaticResource PlanerHeaderTemplate}" Header="{Binding HeadSlotPlaner}">
                            <ContentControl ContentTemplate="{StaticResource PlanerTemplate}" Content="{Binding HeadSlotPlaner}"/>
                        </TabItem>
                        <TabItem HeaderTemplate="{StaticResource PlanerHeaderTemplate}" Header="{Binding ChestSlotPlaner}">
                            <ContentControl ContentTemplate="{StaticResource PlanerTemplate}" Content="{Binding ChestSlotPlaner}"/>
                        </TabItem>
                        <TabItem HeaderTemplate="{StaticResource PlanerHeaderTemplate}" Header="{Binding LegSlotPlaner}">
                            <ContentControl ContentTemplate="{StaticResource PlanerTemplate}" Content="{Binding LegSlotPlaner}"/>
                        </TabItem>
                        <TabItem HeaderTemplate="{StaticResource PlanerHeaderTemplate}" Header="{Binding HandSlotPlaner}">
                            <ContentControl ContentTemplate="{StaticResource PlanerTemplate}" Content="{Binding HandSlotPlaner}"/>
                        </TabItem>
                        <TabItem HeaderTemplate="{StaticResource PlanerHeaderTemplate}" Header="{Binding FeetSlotPlaner}">
                            <ContentControl ContentTemplate="{StaticResource PlanerTemplate}" Content="{Binding FeetSlotPlaner}"/>
                        </TabItem>
                        <TabItem HeaderTemplate="{StaticResource PlanerHeaderTemplate}" Header="{Binding RingSlotPlaner}">
                            <ContentControl ContentTemplate="{StaticResource PlanerTemplate}" Content="{Binding RingSlotPlaner}"/>
                        </TabItem>
                        <TabItem HeaderTemplate="{StaticResource PlanerHeaderTemplate}" Header="{Binding NeckSlotPlaner}">
                            <ContentControl ContentTemplate="{StaticResource PlanerTemplate}" Content="{Binding NeckSlotPlaner}"/>
                        </TabItem>
                        <TabItem HeaderTemplate="{StaticResource PlanerHeaderTemplate}" Header="{Binding MainHandSlotPlaner}">
                            <ContentControl ContentTemplate="{StaticResource PlanerTemplate}" Content="{Binding MainHandSlotPlaner}"/>
                        </TabItem>
                        <TabItem HeaderTemplate="{StaticResource PlanerHeaderTemplate}" Header="{Binding OffHandSlotPlaner}">
                            <ContentControl ContentTemplate="{StaticResource PlanerTemplate}" Content="{Binding OffHandSlotPlaner}"/>
                        </TabItem>
                    </TabControl>
                </DockPanel>
            </TabItem>
            <TabItem Header="Advanced Search">
                <TabItem.Resources>
                    <DataTemplate x:Key="SearchResultAbilityTitleTemplate">
                        <StackPanel Orientation="Horizontal" Margin="2,2,2,2">
                            <Image Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="24" Height="24"/>
                            <TextBlock FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0">Ability:</TextBlock>
                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center" Margin="5,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultAbilityContentTemplate">
                        <DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Image DockPanel.Dock="Left" Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="64" Height="64"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock FontWeight="Bold" FontSize="40" VerticalAlignment="Center" Margin="20,0,0,0">Ability:</TextBlock>
                                    <TextBlock Text="{Binding Name}" FontSize="40" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                </StackPanel>
                            </DockPanel>
                            <Separator DockPanel.Dock="Top" Margin="5,5,5,5"/>
                            <Grid VerticalAlignment="Top" Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Column="0" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Animation:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Animation, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityAnimationTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Can be on sidebar:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding CanBeOnSidebar, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYes}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Suppress monster shout:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="2" Text="{Binding RawCanSuppressMonsterShout, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Can target untargettable:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="3" Text="{Binding RawCanTargetUntargetableEnemies, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Cause(s) of death:</TextBlock>
                                <Grid Grid.Column="1" Grid.Row="4" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplateFirst">
                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=DeathsTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock>,</TextBlock>
                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=DeathsTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding CausesOfDeathList}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="0" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">Cost:</TextBlock>
                                <ItemsControl Grid.Column="1" Grid.Row="5" ItemsSource="{Binding CostList}" ItemTemplate="{StaticResource RecipeCostTemplate}" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="6" TextAlignment="Right" Margin="0,10,0,0">Power On Combat Refresh: </TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="6" Text="{Binding RawCombatRefreshBaseAmount, Converter={StaticResource convNullableInt}, ConverterParameter=+, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="7" TextAlignment="Right" Margin="0,10,0,0">Compatible skill:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="7"  Text="{Binding CompatibleSkill, Converter={StaticResource convEnumToText}, ConverterParameter=PowerSkillTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="8" TextAlignment="Right" Margin="0,10,0,0">Consumed Item:</TextBlock>
                                <ContentControl Content="{Binding ConsumedItem}" ContentTemplateSelector="{StaticResource setTypeToTemplateName}" Grid.Column="1" Grid.Row="8" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="9" TextAlignment="Right" Margin="0,10,0,0">Damage Type:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="9"  Text="{Binding DamageType, Converter={StaticResource convEnumToText}, ConverterParameter=DamageTypeTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="10" TextAlignment="Right" Margin="0,10,0,0">Activation:</TextBlock>
                                <Grid Grid.Column="1" Grid.Row="10" Margin="5,10,0,0">
                                    <TextBlock Visibility="{Binding RawDelayLoopTime, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource VisibleCollapsed}, FallbackValue=Visible}">Instant</TextBlock>
                                    <StackPanel Orientation="Horizontal" Visibility="{Binding RawDelayLoopTime, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}">
                                        <StackPanel Orientation="Horizontal" Visibility="{Binding DelayLoopMessage, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}">
                                            <TextBlock Text="{Binding DelayLoopMessage}" Margin="0,0,5,0"/>
                                            <TextBlock>(</TextBlock>
                                            <TextBlock Text="{Binding DelayLoopTime}"/>
                                            <TextBlock>s)</TextBlock>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Visibility="{Binding DelayLoopMessage, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource VisibleCollapsed}, FallbackValue=Visible}">
                                            <TextBlock Text="{Binding DelayLoopTime}"/>
                                            <TextBlock>s</TextBlock>
                                        </StackPanel>
                                        <Grid Visibility="{Binding RawDelayLoopIsAbortedIfAttacked, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}">
                                            <TextBlock Visibility="{Binding DelayLoopIsAbortedIfAttacked, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource VisibleCollapsed}, FallbackValue=Collapsed}">, not aborted if attacked</TextBlock>
                                            <TextBlock Visibility="{Binding DelayLoopIsAbortedIfAttacked, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Visible}">, aborted if attacked</TextBlock>
                                        </Grid>
                                    </StackPanel>
                                </Grid>
                                <TextBlock Grid.Column="0" Grid.Row="11" TextAlignment="Right" Margin="0,10,0,0">Description:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="11" Text="{Binding Description, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="12" TextAlignment="Right" Margin="0,10,0,0">Appears enabled:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="12" Text="{Binding EffectKeywordsIndicatingEnabled, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityIndicatingEnabledTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="13" TextAlignment="Right" Margin="0,10,0,0">Is Internal:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="13" Text="{Binding RawInternalAbility, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="14" TextAlignment="Right" Margin="0,10,0,0">Is Harmless:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="14" Text="{Binding RawIsHarmless, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="15" TextAlignment="Right" Margin="0,10,0,0">Error message:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="15" Text="{Binding ItemKeywordReqErrorMessage, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="16" TextAlignment="Right" Margin="0,10,0,0">Requirements:</TextBlock>
                                <ItemsControl Grid.Column="1" Grid.Row="16" ItemsSource="{Binding CombinedRequirementList}" ItemTemplateSelector="{StaticResource setTypeToTemplateName}" Margin="5,10,0,0">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                                <TextBlock Grid.Column="0" Grid.Row="17" TextAlignment="Right" Margin="0,10,0,0">Tooltip Extra Keywords:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="17" Text="{Binding ExtraKeywordsForTooltips, Converter={StaticResource convEnumToText}, ConverterParameter=TooltipsExtraKeywordsTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Keywords:</TextBlock>
                                <Grid Grid.Column="3" Grid.Row="0" Margin="5,0,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplateFirst">
                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=AbilityKeywordTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock>,</TextBlock>
                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=AbilityKeywordTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding KeywordList}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="2" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Level:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="1" Text="{Binding Level, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Pet type requirement:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="2" Text="{Binding PetTypeTagReq, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityPetTypeTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Max simultaneous pets:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="3" Text="{Binding RawPetTypeTagReqMax, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Prerequisite:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="4" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Ability_Prerequisite" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding Prerequisite.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="2" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">Projectile:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="5" Text="{Binding Projectile, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityProjectileTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="6" TextAlignment="Right" Margin="0,10,0,0">Reset Time:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="6" Text="{Binding RawResetTime, Converter={StaticResource convDouble}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="7" TextAlignment="Right" Margin="0,10,0,0">Shares Reset Timer With:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="7" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Ability_SharesResetTimerWith" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding SharesResetTimerWith.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="2" Grid.Row="8" TextAlignment="Right" Margin="0,10,0,0">Skill:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="8" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Ability_ConnectedSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding ConnectedSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="2" Grid.Row="9" TextAlignment="Right" Margin="0,10,0,0">Special Info:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="9" Text="{Binding SpecialInfo}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="10" TextAlignment="Right" Margin="0,10,0,0">Target:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="10" Text="{Binding Target, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityTargetTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="11" TextAlignment="Right" Margin="0,10,0,0">Target Requirement:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="11" Text="{Binding TargetEffectKeywordReq, Converter={StaticResource convEnumToText}, ConverterParameter=TargetEffectKeywordTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="12" TextAlignment="Right" Margin="0,10,0,0">Target Particle:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="12" Text="{Binding TargetParticle, Converter={StaticResource convEnumToText}, ConverterParameter=AbilityTargetParticleTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="13" TextAlignment="Right" Margin="0,10,0,0">Upgrade of:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="13" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Ability_UpgradeOf" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding UpgradeOf.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="2" Grid.Row="14" TextAlignment="Right" Margin="0,10,0,0">Works In Combat:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="14" Text="{Binding RawWorksInCombat, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="15" TextAlignment="Right" Margin="0,10,0,0">Works Underwater:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="15" Text="{Binding RawWorksUnderwater, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="16" TextAlignment="Right" Margin="0,10,0,0">Works While Falling:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="16" Text="{Binding RawWorksWhileFalling, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="18" TextAlignment="Right" Margin="0,10,0,0">TODO PvE and PvP damage</TextBlock>
                            </Grid>
                        </DockPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultDirectedGoalTitleTemplate">
                        <StackPanel Orientation="Horizontal" Margin="2,2,2,2">
                            <Image Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="24" Height="24"/>
                            <TextBlock FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0">Goal:</TextBlock>
                            <TextBlock Text="{Binding Label}" VerticalAlignment="Center" Margin="5,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultDirectedGoalContentTemplate">
                        <DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Image DockPanel.Dock="Left" Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="64" Height="64"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock FontWeight="Bold" FontSize="40" VerticalAlignment="Center" Margin="20,0,0,0">Goal:</TextBlock>
                                    <TextBlock Text="{Binding Label}" FontSize="40" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                </StackPanel>
                            </DockPanel>
                            <Separator DockPanel.Dock="Top" Margin="5,5,5,5"/>
                            <Grid VerticalAlignment="Top" Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Column="0" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Zone:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Zone}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Hint:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding Hint}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Needed Skill:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="2" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_DirectedGoal_ConnectedNeededSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding ConnectedNeededSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Needed Skill Level:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="3" Text="{Binding RawNeededSkillLevel, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Needed Ability:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="4" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_DirectedGoal_NeededAbility" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding NeededAbility.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">Needed Recipe:</TextBlock>
                                <StackPanel Grid.Column="1" Grid.Row="5" Orientation="Horizontal" Margin="5,10,0,0">
                                    <TextBlock TextWrapping="Wrap">
                                        <Hyperlink x:Name="hyperlink_DirectedGoal_NeededRecipe" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                            <TextBlock Text="{Binding NeededRecipe.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </Hyperlink>
                                    </TextBlock>
                                    <StackPanel Orientation="Horizontal" Visibility="{Binding RawNeededRecipeCompletions, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Margin="5,0,0,0">
                                        <TextBlock>x</TextBlock>
                                        <TextBlock Text="{Binding NeededRecipeCompletions, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </DockPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultEffectTitleTemplate">
                        <StackPanel Orientation="Horizontal" Margin="2,2,2,2">
                            <Image Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="24" Height="24"/>
                            <TextBlock FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0">Effect:</TextBlock>
                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center" Margin="5,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultEffectContentTemplate">
                        <DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Image DockPanel.Dock="Left" Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="64" Height="64"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock FontWeight="Bold" FontSize="40" VerticalAlignment="Center" Margin="20,0,0,0">Effect:</TextBlock>
                                    <TextBlock Text="{Binding Name}" FontSize="40" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                </StackPanel>
                            </DockPanel>
                            <Grid VerticalAlignment="Top" Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Column="0" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Description:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Desc}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Display Mode:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding DisplayMode, Converter={StaticResource convEnumToText}, ConverterParameter=EffectDisplayModeTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Spew Text:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="2" Text="{Binding SpewText, Converter={StaticResource convReplaceMacro}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Particle:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="3" Text="{Binding Particle, Converter={StaticResource convEnumToText}, ConverterParameter=EffectParticleTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Stacking Type:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="4" Text="{Binding StackingType, Converter={StaticResource convEnumToText}, ConverterParameter=EffectStackingTypeTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">Stacking Priority:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="5" Text="{Binding RawStackingPriority, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="6" TextAlignment="Right" Margin="0,10,0,0">Duration:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="6" Text="{Binding RawDuration, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="7" TextAlignment="Right" Margin="0,10,0,0">Keywords:</TextBlock>
                                <Grid Grid.Column="1" Grid.Row="7" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplateFirst">
                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=EffectKeywordTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock>,</TextBlock>
                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=EffectKeywordTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding KeywordList}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="0" Grid.Row="8" TextAlignment="Right" Margin="0,10,0,0">Ability Keywords:</TextBlock>
                                <Grid Grid.Column="1" Grid.Row="8" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplateFirst">
                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=AbilityKeywordTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock>,</TextBlock>
                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=AbilityKeywordTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding AbilityKeywordList}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                            </Grid>
                        </DockPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultItemTitleTemplate">
                        <StackPanel Orientation="Horizontal" Margin="2,2,2,2">
                            <Image Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="24" Height="24"/>
                            <TextBlock FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0">Item:</TextBlock>
                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center" Margin="5,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultItemContentTemplate">
                        <DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Image DockPanel.Dock="Left" Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="64" Height="64"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock FontWeight="Bold" FontSize="40" VerticalAlignment="Center" Margin="20,0,0,0">Item:</TextBlock>
                                    <TextBlock Text="{Binding Name}" FontSize="40" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                </StackPanel>
                            </DockPanel>
                            <Grid VerticalAlignment="Top" Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Column="0" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Description:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Description}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Bestow Recipes:</TextBlock>
                                <Grid Grid.Column="1" Grid.Row="1" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                        <Hyperlink x:Name="hyperlink_Item_Value" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding Value.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                    </TextBlock>
                                                <TextBlock Margin="0,0,5,0">,</TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplateLast">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                        <Hyperlink x:Name="hyperlink_Item_Value" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding Value.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                    </TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding BestowRecipeTable, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="0" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Bestow Ability:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="2" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Item_BestowAbility" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding BestowAbility.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Bestow Quest:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="3" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Item_BestowQuest" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding BestowQuest.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Allow Prefix:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="4" Text="{Binding RawAllowPrefix, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">Allow Suffix:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="5" Text="{Binding RawAllowSuffix, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="6" TextAlignment="Right" Margin="0,10,0,0">Craft Points:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="6" Text="{Binding RawCraftPoints, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="7" TextAlignment="Right" Margin="0,10,0,0">Crafting Target Level:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="7" Text="{Binding RawCraftingTargetLevel, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="8" TextAlignment="Right" Margin="0,10,0,0">Dropped Appearance:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="8" Text="{Binding DroppedAppearance, Converter={StaticResource convEnumToText}, ConverterParameter=ItemDroppedAppearanceTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="9" TextAlignment="Right" Margin="0,10,0,0">Effect description:</TextBlock>
                                <Grid Grid.Column="1" Grid.Row="9" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplateFirst">
                                            <ContentControl Content="{Binding}" ContentTemplateSelector="{StaticResource setTypeToTemplateName}"/>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock>,</TextBlock>
                                                <ContentControl Content="{Binding}" ContentTemplateSelector="{StaticResource setTypeToTemplateName}" Margin="5,0,0,0"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding EffectDescriptionList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="0" Grid.Row="10" TextAlignment="Right" Margin="0,10,0,0">Dye Color:</TextBlock>
                                <Rectangle Grid.Column="1" Grid.Row="10" Fill="{Binding DyeColor, Converter={StaticResource convRgbColorToBrush}, FallbackValue=Transparent}" HorizontalAlignment="Left" Width="50" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="11" TextAlignment="Right" Margin="0,10,0,0">Slot:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="11" Text="{Binding EquipSlot, Converter={StaticResource convEnumToText}, ConverterParameter=ItemSlotTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="12" TextAlignment="Right" Margin="0,10,0,0">Is Temporary:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="12" Text="{Binding RawIsTemporary, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="13" TextAlignment="Right" Margin="0,10,0,0">Is Crafted:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="13" Text="{Binding RawIsCrafted, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="14" TextAlignment="Right" Margin="0,10,0,0">Keywords:</TextBlock>
                                <Grid Grid.Column="1" Grid.Row="14" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplateFirst">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding Key, Converter={StaticResource convEnumToText}, ConverterParameter=ItemKeywordTextMap, FallbackValue={x:Null}}"/>
                                                <StackPanel Visibility="{Binding Value.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                                                    <TextBlock>(</TextBlock>
                                                    <TextBlock Text="{Binding Value, Converter={StaticResource convFloatListToString}}"/>
                                                    <TextBlock>)</TextBlock>
                                                </StackPanel>
                                            </StackPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock>,</TextBlock>
                                                <TextBlock Text="{Binding Key, Converter={StaticResource convEnumToText}, ConverterParameter=ItemKeywordTextMap, FallbackValue={x:Null}}" Margin="5,0,0,0"/>
                                                <StackPanel Visibility="{Binding Value.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                                                    <TextBlock>(</TextBlock>
                                                    <TextBlock Text="{Binding Value, Converter={StaticResource convFloatListToString}}"/>
                                                    <TextBlock>)</TextBlock>
                                                </StackPanel>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding KeywordTable, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="0" Grid.Row="15" TextAlignment="Right" Margin="0,10,0,0">Associated Quest:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="15" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Item_MacGuffinQuestName" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding MacGuffinQuestName.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="2" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Max Carryable:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="0" Text="{Binding RawMaxCarryable, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Max On Vendor:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="1" Text="{Binding RawMaxOnVendor, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Max Stack Size:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="2" Text="{Binding RawMaxStackSize, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Metabolism Cost:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="3" Text="{Binding RawMetabolismCost, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Required Appearance:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="4" Text="{Binding RequiredAppearance, Converter={StaticResource convEnumToText}, ConverterParameter=AppearanceTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">Other Requirements:</TextBlock>
                                <ItemsControl Grid.Column="3" Grid.Row="5" ItemsSource="{Binding OtherRequirementList}" ItemTemplateSelector="{StaticResource setTypeToTemplateName}" Margin="5,10,0,0">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                                <TextBlock Grid.Column="2" Grid.Row="6" TextAlignment="Right" Margin="0,10,0,0">Skill Requirements:</TextBlock>
                                <Grid Grid.Column="3" Grid.Row="6" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                    <Hyperlink x:Name="hyperlink_Item_Link" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                        <TextBlock Text="{Binding Link.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                    </Hyperlink>
                                                </TextBlock>
                                                <StackPanel Visibility="{Binding HasLevel, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal">
                                                    <TextBlock Margin="5,0,0,0">(</TextBlock>
                                                    <TextBlock Text="{Binding ParsedLevel, FallbackValue={x:Null}}"/>
                                                    <TextBlock>)</TextBlock>
                                                </StackPanel>
                                                <TextBlock Margin="0,0,5,0">,</TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplateLast">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                    <Hyperlink x:Name="hyperlink_Item_Link" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                        <TextBlock Text="{Binding Link.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                    </Hyperlink>
                                                </TextBlock>
                                                <StackPanel Visibility="{Binding HasLevel, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal">
                                                    <TextBlock Margin="5,0,0,0">(</TextBlock>
                                                    <TextBlock Text="{Binding ParsedLevel, FallbackValue={x:Null}}"/>
                                                    <TextBlock>)</TextBlock>
                                                </StackPanel>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding SkillRequirementList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="2" Grid.Row="7" TextAlignment="Right" Margin="0,10,0,0">Use Delay:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="7" Text="{Binding RawUseDelay, Converter={StaticResource convDouble}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="8" TextAlignment="Right" Margin="0,10,0,0">Use Delay Animation:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="8" Text="{Binding UseDelayAnimation, Converter={StaticResource convEnumToText}, ConverterParameter=ItemUseAnimationTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="9" TextAlignment="Right" Margin="0,10,0,0">Use Animation:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="9" Text="{Binding UseAnimation, Converter={StaticResource convEnumToText}, ConverterParameter=ItemUseAnimationTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="10" TextAlignment="Right" Margin="0,10,0,0">Stock Dye:</TextBlock>
                                <ItemsControl Grid.Column="3" Grid.Row="10" ItemsSource="{Binding StockDye}" HorizontalAlignment="Left" Margin="5,10,0,0">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <VirtualizingStackPanel Orientation="Horizontal"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Rectangle Fill="{Binding Converter={StaticResource convRgbColorToBrush}, FallbackValue=Transparent}" Width="50" Margin="0,0,10,0"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                <TextBlock Grid.Column="2" Grid.Row="11" TextAlignment="Right" Margin="0,10,0,0">Use Requirements:</TextBlock>
                                <Grid Grid.Column="3" Grid.Row="11" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=ItemUseRequirementTextMap}"/>
                                                <TextBlock Margin="0,0,5,0">,</TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplateLast">
                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=ItemUseRequirementTextMap}"/>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding UseRequirementList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="2" Grid.Row="12" TextAlignment="Right" Margin="0,10,0,0">Use Verb:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="12" Text="{Binding UseVerb, Converter={StaticResource convEnumToText}, ConverterParameter=ItemUseVerbTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="13" TextAlignment="Right" Margin="0,10,0,0">Value:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="13" Text="{Binding RawValue, Converter={StaticResource convDouble}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="14" TextAlignment="Right" Margin="0,10,0,0">Number of Uses:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="14" Text="{Binding RawNumUses, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="15" TextAlignment="Right" Margin="0,10,0,0">Destroy When Used Up:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="15" Text="{Binding RawDestroyWhenUsedUp, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                            </Grid>
                        </DockPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultQuestTitleTemplate">
                        <StackPanel Orientation="Horizontal" Margin="2,2,2,2">
                            <Image Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="24" Height="24"/>
                            <TextBlock FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0">Quest:</TextBlock>
                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center" Margin="5,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultQuestContentTemplate">
                        <DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Image DockPanel.Dock="Left" Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="64" Height="64"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock FontWeight="Bold" FontSize="40" VerticalAlignment="Center" Margin="20,0,0,0">Quest:</TextBlock>
                                    <TextBlock Text="{Binding Name}" FontSize="40" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                </StackPanel>
                            </DockPanel>
                            <Grid VerticalAlignment="Top" Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Column="0" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Description:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Description}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Version:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding RawVersion, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Reuse Time:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="2" Text="{Binding RawReuseTime, Converter={StaticResource convNullableTimeSpanToDuration}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Is Cancellable:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="3" Text="{Binding RawIsCancellable, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Quest Objectives:</TextBlock>
                                <ItemsControl Grid.Column="1" Grid.Row="4" ItemsSource="{Binding QuestObjectiveList}" ItemTemplateSelector="{StaticResource setTypeToTemplateName}" HorizontalAlignment="Left" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">XP Rewards:</TextBlock>
                                <Grid Grid.Column="1" Grid.Row="5" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                        <Hyperlink x:Name="hyperlink_QuestRewardXp_ConnectedSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding ConnectedSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                    </TextBlock>
                                                <TextBlock Margin="5,0,0,0">(</TextBlock>
                                                <TextBlock Text="{Binding Xp}"/>
                                                <TextBlock Margin="0,0,5,0">),</TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplateLast">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                        <Hyperlink x:Name="hyperlink_QuestRewardXp_ConnectedSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding ConnectedSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                </TextBlock>
                                                <TextBlock Margin="5,0,0,0">(</TextBlock>
                                                <TextBlock Text="{Binding Xp}"/>
                                                <TextBlock>)</TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding RewardsXPList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="0" Grid.Row="6" TextAlignment="Right" Margin="0,10,0,0">Item Rewards:</TextBlock>
                                <Grid Grid.Column="1" Grid.Row="6" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                        <Hyperlink x:Name="hyperlink_QuestRewardItem_QuestItem" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding QuestItem.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                    </TextBlock>
                                                <StackPanel Visibility="{Binding RawStackSize, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                                                    <TextBlock>x</TextBlock>
                                                    <TextBlock Text="{Binding StackSize}"/>
                                                </StackPanel>
                                                <TextBlock Margin="0,0,5,0">,</TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplateLast">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                        <Hyperlink x:Name="hyperlink_QuestRewardItem_QuestItem" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding QuestItem.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                    </TextBlock>
                                                <StackPanel Visibility="{Binding RawStackSize, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                                                    <TextBlock>x</TextBlock>
                                                    <TextBlock Text="{Binding StackSize}"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding QuestRewardsItemList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="0" Grid.Row="7" TextAlignment="Right" Margin="0,10,0,0">Prerequisite Quest:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="7" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Quest_PrerequisiteQuest" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding PrerequisiteQuest.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="8" TextAlignment="Right" Margin="0,10,0,0">Combat XP Reward:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="8" Text="{Binding RawRewardCombatXP, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="9" TextAlignment="Right" Margin="0,10,0,0">Favor NPC:</TextBlock>
                                <StackPanel Grid.Column="1" Grid.Row="9" Visibility="{Binding FavorNpc, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,10,0,0">
                                    <TextBlock Text="{Binding FavorNpc, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    <TextBlock Margin="5,0,5,0">in</TextBlock>
                                    <TextBlock Text="{Binding FavorNpcArea, Converter={StaticResource convEnumToText}, ConverterParameter=MapAreaNameTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </StackPanel>
                                <TextBlock Grid.Column="0" Grid.Row="10" TextAlignment="Right" Margin="0,10,0,0">Preface Text:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="10" Text="{Binding PrefaceText, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="11" TextAlignment="Right" Margin="0,10,0,0">Success Text:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="11" Text="{Binding SuccessText, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="12" TextAlignment="Right" Margin="0,10,0,0">Midway Text:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="12" Text="{Binding MidwayText, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="13" TextAlignment="Right" Margin="0,10,0,0">Favor Prerequisite:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="13" Text="{Binding PrerequisiteFavorLevel, Converter={StaticResource convEnumToText}, ConverterParameter=FavorTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="15" TextAlignment="Right" Margin="0,10,0,0">Ability Reward:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="15" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Quest_RewardAbility" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding RewardAbility.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="16" TextAlignment="Right" Margin="0,10,0,0">Favor NPC Requirement:</TextBlock>
                                <StackPanel Grid.Column="1" Grid.Row="16" Visibility="{Binding RequirementFavorNpc, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,10,0,0">
                                    <TextBlock Margin="0,0,5,0">At least</TextBlock>
                                    <TextBlock Text="{Binding RequirementFavorLevel, Converter={StaticResource convEnumToText}, ConverterParameter=FavorTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    <TextBlock Margin="5,0,5,0">with</TextBlock>
                                    <TextBlock Text="{Binding RequirementFavorNpc, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    <TextBlock Margin="5,0,5,0">in</TextBlock>
                                    <TextBlock Text="{Binding RequirementFavorNpcArea, Converter={StaticResource convEnumToText}, ConverterParameter=MapAreaNameTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                </StackPanel>
                                <TextBlock Grid.Column="0" Grid.Row="17" TextAlignment="Right" Margin="0,10,0,0">Quest Requirement:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="17" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Quest_RequirementQuest" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding RequirementQuest.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="18" TextAlignment="Right" Margin="0,10,0,0">Guild Quest Requirement:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="18" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Quest_RequirementGuildQuest" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding RequirementGuildQuest.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="19" TextAlignment="Right" Margin="0,10,0,0">Skill Requirement:</TextBlock>
                                <StackPanel Grid.Column="1" Grid.Row="19" Visibility="{Binding ConnectedRequirementSkill, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,10,0,0">
                                    <TextBlock TextWrapping="Wrap">
                                        <Hyperlink x:Name="hyperlink_Quest_ConnectedRequirementSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                            <TextBlock Text="{Binding ConnectedRequirementSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </Hyperlink>
                                    </TextBlock>
                                    <TextBlock Margin="5,0,5,0">at level</TextBlock>
                                    <TextBlock Text="{Binding RequirementSkillLevel}" />
                                </StackPanel>
                                <TextBlock Grid.Column="2" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Favor Reward:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="0" Text="{Binding RawRewardFavor, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Skill XP Reward:</TextBlock>
                                <StackPanel Grid.Column="3" Grid.Row="1" Visibility="{Binding ConnectedRewardSkill, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,10,0,0">
                                    <TextBlock Text="{Binding RewardSkillXp}"/>
                                    <TextBlock Margin="5,0,5,0">XP in</TextBlock>
                                    <TextBlock TextWrapping="Wrap">
                                        <Hyperlink x:Name="hyperlink_Quest_ConnectedRewardSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                            <TextBlock Text="{Binding ConnectedRewardSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </Hyperlink>
                                    </TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Column="2" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Recipe Reward:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="2" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Quest_RewardRecipe" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding RewardRecipe.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="2" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Guild XP Reward:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="4" Text="{Binding RawRewardGuildXp, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">Guild Credit Reward:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="5" Text="{Binding RawRewardGuildCredits, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="6" TextAlignment="Right" Margin="0,10,0,0">Quest Items Given:</TextBlock>
                                <Grid Grid.Column="3" Grid.Row="6" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                        <Hyperlink x:Name="hyperlink_QuestRewardItem_QuestItem" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding QuestItem.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                    </TextBlock>
                                                <StackPanel Visibility="{Binding RawStackSize, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                                                    <TextBlock>x</TextBlock>
                                                    <TextBlock Text="{Binding StackSize}"/>
                                                </StackPanel>
                                                <TextBlock Margin="0,0,5,0">,</TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplateLast">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                        <Hyperlink x:Name="hyperlink_QuestRewardItem_QuestItem" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding QuestItem.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                    </TextBlock>
                                                <StackPanel Visibility="{Binding RawStackSize, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal" Margin="5,0,0,0">
                                                    <TextBlock>x</TextBlock>
                                                    <TextBlock Text="{Binding StackSize}"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding PreGiveItemList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="2" Grid.Row="7" TextAlignment="Right" Margin="0,10,0,0">Level:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="7" Text="{Binding RawTSysLevel, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="8" TextAlignment="Right" Margin="0,10,0,0">Gold Reward:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="8" Text="{Binding RawRewardGold, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="9" TextAlignment="Right" Margin="0,10,0,0">Recipes Given:</TextBlock>
                                <Grid Grid.Column="3" Grid.Row="9" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                    <Hyperlink x:Name="hyperlink_Recipe_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                        <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                    </Hyperlink>
                                                </TextBlock>
                                                <TextBlock Margin="0,0,5,0">,</TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplateLast">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock TextWrapping="Wrap">
                                                    <Hyperlink x:Name="hyperlink_Recipe_hyperlink" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                        <TextBlock Text="{Binding Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                    </Hyperlink>
                                                </TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding PreGiveRecipeList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="2" Grid.Row="10" TextAlignment="Right" Margin="0,10,0,0">Keywords:</TextBlock>
                                <Grid Grid.Column="3" Grid.Row="10" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=QuestKeywordTextMap}"/>
                                                <TextBlock Margin="0,0,5,0">,</TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplateLast">
                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=QuestKeywordTextMap}"/>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding KeywordList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="2" Grid.Row="11" TextAlignment="Right" Margin="0,10,0,0">Effect Reward:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="11" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Quest_RewardEffect" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding RewardEffect.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="2" Grid.Row="12" TextAlignment="Right" Margin="0,10,0,0">Is Auto Preface:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="12" Text="{Binding RawIsAutoPreface, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="13" TextAlignment="Right" Margin="0,10,0,0">Is Auto WrapUp:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="13" Text="{Binding RawIsAutoWrapUp, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="14" TextAlignment="Right" Margin="0,10,0,0">Grouping Name:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="14" Text="{Binding GroupingName, Converter={StaticResource convEnumToText}, ConverterParameter=QuestGroupingNameTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="15" TextAlignment="Right" Margin="0,10,0,0">Is Guild Quest:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="15" Text="{Binding RawIsGuildQuest, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="16" TextAlignment="Right" Margin="0,10,0,0">Expected Number Of Participants:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="16" Text="{Binding RawNumExpectedParticipants, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="17" TextAlignment="Right" Margin="0,10,0,0">Level:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="17" Text="{Binding RawLevel, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="18" TextAlignment="Right" Margin="0,10,0,0">Work Order Skill:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="18" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Quest_ConnectedWorkOrderSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding ConnectedWorkOrderSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="2" Grid.Row="19" TextAlignment="Right" Margin="0,10,0,0">Requirement to sustain:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="19" Text="{Binding RequirementToSustain, Converter={StaticResource convEnumToText}, ConverterParameter=EffectKeywordTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                            </Grid>
                        </DockPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultRecipeTitleTemplate">
                        <StackPanel Orientation="Horizontal" Margin="2,2,2,2">
                            <Image Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="24" Height="24"/>
                            <TextBlock FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0">Recipe:</TextBlock>
                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center" Margin="5,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultRecipeContentTemplate">
                        <DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Image DockPanel.Dock="Left" Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="64" Height="64"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock FontWeight="Bold" FontSize="40" VerticalAlignment="Center" Margin="20,0,0,0">Recipe:</TextBlock>
                                    <TextBlock Text="{Binding Name}" FontSize="40" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                </StackPanel>
                            </DockPanel>
                            <Grid VerticalAlignment="Top" Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Column="0" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Description:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Description}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Ingredients:</TextBlock>
                                <ItemsControl Grid.Column="1" Grid.Row="1" ItemsSource="{Binding IngredientList}" ItemTemplateSelector="{StaticResource setTypeToTemplateName}" HorizontalAlignment="Left" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Result:</TextBlock>
                                <ItemsControl Grid.Column="1" Grid.Row="2" ItemsSource="{Binding ResultItemList}" ItemTemplateSelector="{StaticResource setTypeToTemplateName}" HorizontalAlignment="Left" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Skill:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="3" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Recipe_ConnectedSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding ConnectedSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Required Level:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="4" Text="{Binding RawSkillLevelReq, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">Result Effects:</TextBlock>
                                <ItemsControl Grid.Column="1" Grid.Row="5" ItemsSource="{Binding ResultEffectList}" HorizontalAlignment="Left" Margin="5,10,0,0">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding CombinedEffect}"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                <TextBlock Grid.Column="0" Grid.Row="6" TextAlignment="Right" Margin="0,10,0,0">Sort Skill:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="6" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Recipe_ConnectedSortSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding ConnectedSortSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="0" Grid.Row="7" TextAlignment="Right" Margin="0,10,0,0">Keywords:</TextBlock>
                                <Grid Grid.Column="1" Grid.Row="7" Margin="5,10,0,0">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="ItemTemplate">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RecipeKeywordTextMap}"/>
                                                <TextBlock Margin="0,0,5,0">,</TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="ItemTemplateLast">
                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RecipeKeywordTextMap}"/>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <ItemsControl ItemsSource="{Binding KeywordList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </Grid>
                                <TextBlock Grid.Column="0" Grid.Row="8" TextAlignment="Right" Margin="0,10,0,0">Action:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="8" Text="{Binding ActionLabel, Converter={StaticResource convEnumToText}, ConverterParameter=RecipeActionTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="9" TextAlignment="Right" Margin="0,10,0,0">Usage Delay:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="9" Text="{Binding RawUsageDelay, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="0" Grid.Row="10" TextAlignment="Right" FontStyle="Italic" Margin="0,10,0,0">Cotton cost:</TextBlock>
                                <TextBlock Grid.Column="1" Grid.Row="10" Text="{Binding PerfectCottonRatio, Converter={StaticResource convDouble}, FallbackValue={x:Null}}" TextWrapping="Wrap" FontStyle="Italic" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Usage Delay Message:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="0" Text="{Binding UsageDelayMessage, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Usage Animation:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="1" Text="{Binding UsageAnimation, Converter={StaticResource convEnumToText}, ConverterParameter=RecipeUsageAnimationTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Other Requirements:</TextBlock>
                                <ItemsControl Grid.Column="3" Grid.Row="2" ItemsSource="{Binding OtherRequirementList}" ItemTemplateSelector="{StaticResource setTypeToTemplateName}" Margin="5,10,0,0">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                                <TextBlock Grid.Column="2" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Cost:</TextBlock>
                                <ItemsControl Grid.Column="3" Grid.Row="3" ItemsSource="{Binding CostList}" ItemTemplate="{StaticResource RecipeCostTemplate}" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Number of Resulting Items:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="4" Text="{Binding RawNumResultItems, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">Reset Time (in seconds):</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="5" Text="{Binding RawResetTimeInSeconds, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="6" TextAlignment="Right" Margin="0,10,0,0">Dye Color:</TextBlock>
                                <Rectangle Grid.Column="3" Grid.Row="6" Fill="{Binding DyeColor, Converter={StaticResource convRgbColorToBrush}, FallbackValue=Transparent}" HorizontalAlignment="Left" Width="50" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="7" TextAlignment="Right" Margin="0,10,0,0">Reward Skill:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="7" TextWrapping="Wrap" Margin="5,10,0,0">
                                    <Hyperlink x:Name="hyperlink_Recipe_ConnectedRewardSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                        <TextBlock Text="{Binding ConnectedRewardSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <TextBlock Grid.Column="2" Grid.Row="8" TextAlignment="Right" Margin="0,10,0,0">XP Reward:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="8" Text="{Binding RawRewardSkillXp, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                <TextBlock Grid.Column="2" Grid.Row="9" TextAlignment="Right" Margin="0,10,0,0">First Time XP Reward:</TextBlock>
                                <TextBlock Grid.Column="3" Grid.Row="9" Text="{Binding RawRewardSkillXpFirstTime, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                            </Grid>
                        </DockPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultSkillTitleTemplate">
                        <StackPanel Orientation="Horizontal" Margin="2,2,2,2">
                            <Image Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="24" Height="24"/>
                            <TextBlock FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0">Skill:</TextBlock>
                            <TextBlock Text="{Binding Name}" VerticalAlignment="Center" Margin="5,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultSkillContentTemplate">
                        <DockPanel LostFocus="OnContentTemplateLostFocus">
                            <DockPanel DockPanel.Dock="Top">
                                <Image DockPanel.Dock="Left" Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="64" Height="64"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock FontWeight="Bold" FontSize="40" VerticalAlignment="Center" Margin="20,0,0,0">Skill:</TextBlock>
                                    <TextBlock Text="{Binding Name}" FontSize="40" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                </StackPanel>
                            </DockPanel>
                            <Grid VerticalAlignment="Top" Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="0" VerticalAlignment="Top">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Column="0" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Description:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Description}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                    <TextBlock Grid.Column="0" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Hide When Zero:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding RawHideWhenZero, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                    <TextBlock Grid.Column="0" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">XP Table:</TextBlock>
                                    <Grid Grid.Column="1" Grid.Row="2" HorizontalAlignment="Left" Margin="5,10,0,0">
                                        <DockPanel>
                                            <ToggleButton x:Name="buttonXpTable" DockPanel.Dock="Right" Width="20" Height="20" Template="{StaticResource XpTableToggleButton}" ClickMode="Press" Checked="OnXpTableButtonChecked"/>
                                            <TextBlock Grid.Column="0" Grid.Row="2" Text="{Binding XpTable.EnumName, Converter={StaticResource convEnumToText}, ConverterParameter=XpTableEnumTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="0,0,10,0"/>
                                        </DockPanel>
                                        <Popup IsOpen="{Binding ElementName=buttonXpTable, Path=IsChecked}" Placement="Bottom" AllowsTransparency="False" Focusable="False" MaxHeight="400">
                                            <ListView ItemsSource="{Binding XpTable.XpAmountList}" ScrollViewer.VerticalScrollBarVisibility="Visible">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Focusable" Value="false"/>
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View>
                                                    <GridView>
                                                        <GridViewColumn DisplayMemberBinding="{Binding Xp}" Header="XP to reach" Width="100"/>
                                                        <GridViewColumn DisplayMemberBinding="{Binding Level}" Header="Level" Width="50"/>
                                                        <GridViewColumn DisplayMemberBinding="{Binding TotalXp}" Header="Total" Width="80"/>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                        </Popup>
                                    </Grid>
                                    <TextBlock Grid.Column="0" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Advancement Table:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="3" Text="{Binding AdvancementTable.InternalName, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                    <TextBlock Grid.Column="0" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Combat:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="4" Text="{Binding RawCombat, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                    <TextBlock Grid.Column="0" Grid.Row="5" TextAlignment="Right" Margin="0,10,0,0">Compatible Skills:</TextBlock>
                                    <Grid Grid.Column="1" Grid.Row="5" Margin="5,10,0,0">
                                        <Grid.Resources>
                                            <DataTemplate x:Key="ItemTemplate">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=PowerSkillTextMap}"/>
                                                    <TextBlock Margin="0,0,5,0">,</TextBlock>
                                                </StackPanel>
                                            </DataTemplate>
                                            <DataTemplate x:Key="ItemTemplateLast">
                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=PowerSkillTextMap}"/>
                                            </DataTemplate>
                                        </Grid.Resources>
                                        <ItemsControl ItemsSource="{Binding CompatibleCombatSkillList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel/>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                        </ItemsControl>
                                    </Grid>
                                    <TextBlock Grid.Column="0" Grid.Row="6" TextAlignment="Right" Margin="0,10,0,0">Max Bonus Levels:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="6" Text="{Binding RawMaxBonusLevels, Converter={StaticResource convNullableInt}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                    <TextBlock Grid.Column="0" Grid.Row="7" TextAlignment="Right" Margin="0,10,0,0">Parent Skill:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="7" TextWrapping="Wrap" Margin="5,10,0,0">
                                        <Hyperlink x:Name="hyperlink_Recipe_ConnectedParentSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                            <TextBlock Text="{Binding ConnectedParentSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        </Hyperlink>
                                    </TextBlock>
                                    <TextBlock Grid.Column="0" Grid.Row="8" TextAlignment="Right" Margin="0,10,0,0">Skip Bonus Levels If Skill Unlearned:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="8" Text="{Binding RawSkipBonusLevelsIfSkillUnlearned, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                    <TextBlock Grid.Column="0" Grid.Row="9" TextAlignment="Right" Margin="0,10,0,0">Is Auxiliary Combat Skill:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="9" Text="{Binding RawAuxCombat, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                </Grid>
                                <Grid Grid.Column="1" VerticalAlignment="Top" HorizontalAlignment="Center">
                                    <Grid.Resources>
                                        <DataTemplate x:Key="SkillRewardAbilityTemplate">
                                            <WrapPanel>
                                                <TextBlock TextWrapping="Wrap" Margin="0,0,5,0">
                                                    <Span>
                                                        <Run>Level </Run>
                                                        <Run Text="{Binding RewardLevel, Mode=OneWay}"/>
                                                        <Run>, ability: </Run>
                                                        <Hyperlink x:Name="hyperlink_SkillRewardAbility_Ability" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding Ability.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                    </Span>
                                                </TextBlock>
                                                <StackPanel Visibility="{Binding RaceRestrictionList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal">
                                                    <StackPanel.Resources>
                                                        <DataTemplate x:Key="ItemTemplate">
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" FontStyle="Italic"/>
                                                                <TextBlock FontStyle="Italic" Margin="0,0,5,0">,</TextBlock>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                        <DataTemplate x:Key="ItemTemplateLast">
                                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" FontStyle="Italic"/>
                                                        </DataTemplate>
                                                    </StackPanel.Resources>
                                                    <TextBlock FontStyle="Italic">(Only if</TextBlock>
                                                    <ItemsControl ItemsSource="{Binding RaceRestrictionList}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <StackPanel Orientation="Horizontal"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                    </ItemsControl>
                                                    <TextBlock FontStyle="Italic">)</TextBlock>
                                                </StackPanel>
                                            </WrapPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="SkillRewardBonusLevelTemplate">
                                            <WrapPanel>
                                                <TextBlock TextWrapping="Wrap" Margin="0,0,5,0">
                                                    <Span>
                                                        <Run>Level</Run>
                                                        <Run Text="{Binding RewardLevel, Mode=OneWay}"/>
                                                        <Run>, +1 in </Run>
                                                        <Hyperlink x:Name="hyperlink_SkillRewardBonusLevel_Skill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding Skill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                    </Span>
                                                </TextBlock>
                                                <StackPanel Visibility="{Binding RaceRestrictionList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal">
                                                    <StackPanel.Resources>
                                                        <DataTemplate x:Key="ItemTemplate">
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" FontStyle="Italic"/>
                                                                <TextBlock FontStyle="Italic" Margin="0,0,5,0">,</TextBlock>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                        <DataTemplate x:Key="ItemTemplateLast">
                                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" FontStyle="Italic"/>
                                                        </DataTemplate>
                                                    </StackPanel.Resources>
                                                    <TextBlock FontStyle="Italic">(Only if</TextBlock>
                                                    <ItemsControl ItemsSource="{Binding RaceRestrictionList}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <StackPanel Orientation="Horizontal"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                    </ItemsControl>
                                                    <TextBlock FontStyle="Italic">)</TextBlock>
                                                </StackPanel>
                                            </WrapPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="SkillRewardMiscTemplate">
                                            <WrapPanel>
                                                <TextBlock TextWrapping="Wrap" Margin="0,0,5,0">
                                                    <Span>
                                                        <Run Text="{Binding Text, Mode=OneWay}"/>
                                                    </Span>
                                                </TextBlock>
                                                <StackPanel Visibility="{Binding RaceRestrictionList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal">
                                                    <StackPanel.Resources>
                                                        <DataTemplate x:Key="ItemTemplate">
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" FontStyle="Italic"/>
                                                                <TextBlock FontStyle="Italic" Margin="0,0,5,0">,</TextBlock>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                        <DataTemplate x:Key="ItemTemplateLast">
                                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" FontStyle="Italic"/>
                                                        </DataTemplate>
                                                    </StackPanel.Resources>
                                                    <TextBlock FontStyle="Italic">(Only if</TextBlock>
                                                    <ItemsControl ItemsSource="{Binding RaceRestrictionList}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <StackPanel Orientation="Horizontal"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                    </ItemsControl>
                                                    <TextBlock FontStyle="Italic">)</TextBlock>
                                                </StackPanel>
                                            </WrapPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="SkillRewardRecipeTemplate">
                                            <WrapPanel>
                                                <TextBlock TextWrapping="Wrap" Margin="0,0,5,0">
                                                    <Span>
                                                        <Run>Level </Run>
                                                        <Run Text="{Binding RewardLevel, Mode=OneWay}"/>
                                                        <Run>, recipe: </Run>
                                                        <Hyperlink x:Name="hyperlink_SkillRewardRecipe_Recipe" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                            <TextBlock Text="{Binding Recipe.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                        </Hyperlink>
                                                    </Span>
                                                </TextBlock>
                                                <StackPanel Visibility="{Binding RaceRestrictionList.Count, Converter={StaticResource convIntToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" Orientation="Horizontal">
                                                    <StackPanel.Resources>
                                                        <DataTemplate x:Key="ItemTemplate">
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" FontStyle="Italic"/>
                                                                <TextBlock FontStyle="Italic" Margin="0,0,5,0">,</TextBlock>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                        <DataTemplate x:Key="ItemTemplateLast">
                                                            <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=RaceTextMap, FallbackValue={x:Null}}" FontStyle="Italic"/>
                                                        </DataTemplate>
                                                    </StackPanel.Resources>
                                                    <TextBlock FontStyle="Italic">(Only if</TextBlock>
                                                    <ItemsControl ItemsSource="{Binding RaceRestrictionList}" ItemTemplateSelector="{StaticResource selListMember}" Margin="5,0,0,0">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <StackPanel Orientation="Horizontal"/>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                    </ItemsControl>
                                                    <TextBlock FontStyle="Italic">)</TextBlock>
                                                </StackPanel>
                                            </WrapPanel>
                                        </DataTemplate>
                                        <DataTemplate x:Key="SkillRewardUnlockTemplate">
                                            <TextBlock TextWrapping="Wrap">
                                                <Span>
                                                    <Run>Level</Run>
                                                    <Run Text="{Binding RewardLevel, Mode=OneWay}"/>
                                                    <Run>, unlock </Run>
                                                    <Hyperlink x:Name="hyperlink_SkillRewardBonusLevel_Skill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                        <TextBlock Text="{Binding Skill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                                    </Hyperlink>
                                                    <Run> level </Run>
                                                    <Run Text="{Binding Level, Mode=OneWay}"/>
                                                </Span>
                                            </TextBlock>
                                        </DataTemplate>
                                    </Grid.Resources>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" TextAlignment="Right" Margin="0,0,0,0">Progress:</TextBlock>
                                    <ItemsControl Grid.Column="1" ItemsSource="{Binding CombinedRewardList}" HorizontalAlignment="Left" ItemTemplateSelector="{StaticResource selSkillReward}" Margin="5,0,0,0"/>
                                </Grid>
                            </Grid>
                        </DockPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultPowerTitleTemplate">
                        <StackPanel Orientation="Horizontal" Margin="2,2,2,2">
                            <Image Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="24" Height="24"/>
                            <TextBlock FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0">Mod:</TextBlock>
                            <TextBlock Text="{Binding ComposedName}" VerticalAlignment="Center" Margin="5,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                    <DataTemplate x:Key="SearchResultPowerContentTemplate">
                        <DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Image DockPanel.Dock="Left" Source="{Binding SearchResultIconFileName, Converter={StaticResource convFileNameToBitmapImage}}" VerticalAlignment="Center" Width="64" Height="64"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock FontWeight="Bold" FontSize="40" VerticalAlignment="Center" Margin="20,0,0,0">Mod:</TextBlock>
                                    <TextBlock Text="{Binding ComposedName}" FontSize="40" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                </StackPanel>
                            </DockPanel>
                            <Grid VerticalAlignment="Top" Margin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="0" VerticalAlignment="Top">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Column="0" Grid.Row="0" TextAlignment="Right" Margin="0,0,0,0">Prefix:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Prefix, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,0,0,0"/>
                                    <TextBlock Grid.Column="0" Grid.Row="1" TextAlignment="Right" Margin="0,10,0,0">Suffix:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding Suffix, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                    <TextBlock Grid.Column="0" Grid.Row="2" TextAlignment="Right" Margin="0,10,0,0">Slots:</TextBlock>
                                    <Grid Grid.Column="1" Grid.Row="2" Margin="5,10,0,0">
                                        <Grid.Resources>
                                            <DataTemplate x:Key="ItemTemplate">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=ItemSlotTextMap, FallbackValue={x:Null}}"/>
                                                    <TextBlock Margin="0,0,5,0">,</TextBlock>
                                                </StackPanel>
                                            </DataTemplate>
                                            <DataTemplate x:Key="ItemTemplateLast">
                                                <TextBlock Text="{Binding Converter={StaticResource convEnumToText}, ConverterParameter=ItemSlotTextMap, FallbackValue={x:Null}}"/>
                                            </DataTemplate>
                                        </Grid.Resources>
                                        <ItemsControl ItemsSource="{Binding SlotList, FallbackValue={x:Null}}" ItemTemplateSelector="{StaticResource selListMember}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel/>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                        </ItemsControl>
                                    </Grid>
                                    <TextBlock Grid.Column="0" Grid.Row="3" TextAlignment="Right" Margin="0,10,0,0">Skill:</TextBlock>
                                    <Grid Grid.Column="1" Grid.Row="3" Margin="5,10,0,0">
                                        <TextBlock Visibility="{Binding ConnectedSkill, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource VisibleCollapsed}, FallbackValue=Visible}" Text="{Binding Skill, Converter={StaticResource convEnumToText}, ConverterParameter=PowerSkillTextMap, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                        <TextBlock Visibility="{Binding ConnectedSkill, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible}, FallbackValue=Collapsed}" TextWrapping="Wrap">
                                            <Hyperlink x:Name="hyperlink_Recipe_ConnectedSkill" RequestNavigate="OnRequestNavigate" NavigateUri="unused">
                                                <TextBlock Text="{Binding ConnectedSkill.Name, FallbackValue={x:Null}}" TextWrapping="Wrap"/>
                                            </Hyperlink>
                                        </TextBlock>
                                    </Grid>
                                    <TextBlock Grid.Column="0" Grid.Row="4" TextAlignment="Right" Margin="0,10,0,0">Is Unavailable:</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="4" Text="{Binding RawIsUnavailable, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource NoYesNull}, FallbackValue={x:Null}}" TextWrapping="Wrap" Margin="5,10,0,0"/>
                                </Grid>
                                <ItemsControl Grid.Column="1" ItemsSource="{Binding CombinedTierList}" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="5,0,0,0">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}" TextWrapping="Wrap" Margin="0,0,0,2"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </Grid>
                        </DockPanel>
                    </DataTemplate>
                </TabItem.Resources>
                <DockPanel Margin="10,10,10,10">
                    <DockPanel DockPanel.Dock="Left" Width="300">
                        <Grid DockPanel.Dock="Top">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Column="0" Grid.Row="0">Search:</TextBlock>
                            <TextBox Grid.Column="1" Grid.Row="0" Text="{Binding SearchTerms, UpdateSourceTrigger=PropertyChanged}" MaxLength="50" KeyDown="OnSearchTermsEntered" Margin="5,0,0,0"/>
                            <CheckBox Grid.Column="1" Grid.Row="1" IsChecked="{Binding MustMatchCase}" Checked="OnSearchCheckChanged" Unchecked="OnSearchCheckChanged" Margin="5,10,0,0">Match case</CheckBox>
                            <CheckBox Grid.Column="1" Grid.Row="2" IsChecked="{Binding MustMatchWholeWord}" Checked="OnSearchCheckChanged" Unchecked="OnSearchCheckChanged" Visibility="Collapsed" Margin="5,10,0,0">Match whole word</CheckBox>
                            <CheckBox Grid.Column="1" Grid.Row="3" IsChecked="{Binding IncludeAbility}" Checked="OnSearchCheckChanged" Unchecked="OnSearchCheckChanged" Margin="5,10,0,0">Abilities</CheckBox>
                            <CheckBox Grid.Column="1" Grid.Row="4" IsChecked="{Binding IncludeDirectedGoal}" Checked="OnSearchCheckChanged" Unchecked="OnSearchCheckChanged" Margin="5,10,0,0">Goals</CheckBox>
                            <CheckBox Grid.Column="1" Grid.Row="5" IsChecked="{Binding IncludeEffect}" Checked="OnSearchCheckChanged" Unchecked="OnSearchCheckChanged" Margin="5,10,0,0">Effects, buffs and debuffs</CheckBox>
                            <CheckBox Grid.Column="1" Grid.Row="6" IsChecked="{Binding IncludeItem}" Checked="OnSearchCheckChanged" Unchecked="OnSearchCheckChanged" Margin="5,10,0,0">Items</CheckBox>
                            <CheckBox Grid.Column="1" Grid.Row="7" IsChecked="{Binding IncludeQuest}" Checked="OnSearchCheckChanged" Unchecked="OnSearchCheckChanged" Margin="5,10,0,0">Quests</CheckBox>
                            <CheckBox Grid.Column="1" Grid.Row="8" IsChecked="{Binding IncludeRecipe}" Checked="OnSearchCheckChanged" Unchecked="OnSearchCheckChanged" Margin="5,10,0,0">Recipes</CheckBox>
                            <CheckBox Grid.Column="1" Grid.Row="9" IsChecked="{Binding IncludeSkill}" Checked="OnSearchCheckChanged" Unchecked="OnSearchCheckChanged" Margin="5,10,0,0">Skills</CheckBox>
                            <CheckBox Grid.Column="1" Grid.Row="10" IsChecked="{Binding IncludePower}" Checked="OnSearchCheckChanged" Unchecked="OnSearchCheckChanged" Margin="5,10,0,0">Treasure effects (mods)</CheckBox>
                        </Grid>
                        <Separator DockPanel.Dock="Top" Margin="5,10,5,10"/>
                        <Expander DockPanel.Dock="Top" Header="Search instructions">
                            <StackPanel>
                                <TextBlock TextWrapping="Wrap" Margin="0,10,0,0">Use AND or OR (case-sensitive, cannot be mixed) to separate terms for complex search. If neither is specified, the search is performed on the exact term, space included.</TextBlock>
                                <TextBlock TextWrapping="Wrap" Margin="0,10,0,0">Example:</TextBlock>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Column="0" Grid.Row="0" TextAlignment="Right" FontStyle="Italic" Margin="0,5,0,0">cold damage AND ice</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="0" Margin="0,5,0,0">:</TextBlock>
                                    <TextBlock Grid.Column="2" Grid.Row="0" TextWrapping="Wrap" Margin="5,5,0,0">search for occurences of "cold damage" and "ice" in the same entry.</TextBlock>
                                    <TextBlock Grid.Column="0" Grid.Row="1" TextAlignment="Right" FontStyle="Italic" Margin="0,5,0,0">nature OR fire OR crushing</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="1" Margin="0,5,0,0">:</TextBlock>
                                    <TextBlock Grid.Column="2" Grid.Row="1" TextWrapping="Wrap" Margin="5,5,0,0">search for occurences of "nature", "fire" or "crushing" in any entry.</TextBlock>
                                    <TextBlock Grid.Column="0" Grid.Row="2" TextAlignment="Right" FontStyle="Italic" Margin="0,5,0,0">stuns opponent</TextBlock>
                                    <TextBlock Grid.Column="1" Grid.Row="2" Margin="0,5,0,0">:</TextBlock>
                                    <TextBlock Grid.Column="2" Grid.Row="2" TextWrapping="Wrap" Margin="5,5,0,0">search for occurences of "stuns opponent" in any entry.</TextBlock>
                                </Grid>
                            </StackPanel>
                        </Expander>
                        <Separator DockPanel.Dock="Top" Margin="5,10,5,10"/>
                        <DockPanel DockPanel.Dock="Top">
                            <Grid DockPanel.Dock="Right" VerticalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Button Grid.Column="0" Command="{StaticResource BackwardCommand}" IsEnabled="{Binding IsBackwardEnabled}">
                                    <Button.Content>
                                        <Image Source="{StaticResource imgUndo}" Width="24" Height="24" Margin="2,2,2,2"/>
                                    </Button.Content>
                                </Button>
                                <Button Grid.Column="1" Command="{StaticResource ForwardCommand}" IsEnabled="{Binding IsForwardEnabled}" Margin="10,0,0,0">
                                    <Button.Content>
                                        <Image Source="{StaticResource imgRedo}" Width="24" Height="24" Margin="2,2,2,2"/>
                                    </Button.Content>
                                </Button>
                            </Grid>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock Text="{Binding SearchResult.Count}"/>
                                <TextBlock Margin="5,0,0,0"> found.</TextBlock>
                            </StackPanel>
                        </DockPanel>
                        <ScrollViewer Margin="0,10,0,0">
                            <ListBox ItemsSource="{Binding SearchResult}" SelectedItem="{Binding SearchSelectedItem}" ItemTemplateSelector="{StaticResource selSearchResultTitle}" BorderBrush="{x:Null}" BorderThickness="0" Margin="0,10,0,0"/>
                        </ScrollViewer>
                    </DockPanel>
                    <ScrollViewer VerticalScrollBarVisibility="Visible" Margin="10,0,10,0">
                        <StackPanel>
                            <ContentControl Content="{Binding CurrentSearchItem}" ContentTemplateSelector="{StaticResource selSearchResultContent}"/>
                            <StackPanel Visibility="{Binding CurrentSearchItem, Converter={StaticResource convNullToObject}, ConverterParameter={StaticResource CollapsedVisible},FallbackValue=Collapsed}">
                                <Separator Margin="0,5,0,5"/>
                                <TextBlock Visibility="{Binding CurrentSearchItem.HasLinkBackTableEntries, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource CollapsedVisible},FallbackValue=Collapsed}" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,5">The following pages link here</TextBlock>
                                <TextBlock Visibility="{Binding CurrentSearchItem.HasLinkBackTableEntries, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource VisibleCollapsed},FallbackValue=Visible}" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,5">There are no pages with links to here</TextBlock>
                            </StackPanel>
                            <ItemsControl ItemsSource="{Binding CurrentSearchItem.LinkBackTable}" ItemTemplateSelector="{StaticResource selLinkBack}"/>
                        </StackPanel>
                    </ScrollViewer>
                </DockPanel>
            </TabItem>
            <TabItem Header="Cruncher (under construction)" IsEnabled="False">
                <TabItem.Resources>
                    <DataTemplate x:Key="CrunchSelectionTemplate">
                        <DockPanel>
                            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                                <TextBlock Text="{Binding PrimarySkill}"/>
                                <TextBlock Margin="5,0,5,0">/</TextBlock>
                                <TextBlock Text="{Binding SecondarySkill}"/>
                            </StackPanel>
                            <Expander>
                                <Expander.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0">DPS:</TextBlock>
                                        <TextBlock Grid.Column="1" Text="{Binding BestDPSRounded}" Margin="5,0,10,0"/>
                                        <TextBlock Grid.Column="2">Duration:</TextBlock>
                                        <TextBlock Grid.Column="3" Text="{Binding BestFightDuration}" Margin="5,0,10,0"/>
                                    </Grid>
                                </Expander.Header>
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Column="0" Grid.Row="0" Text="{Binding AbilityList[0]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding AbilityList[1]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="2" Grid.Row="0" Text="{Binding AbilityList[2]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="3" Grid.Row="0" Text="{Binding AbilityList[3]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="4" Grid.Row="0" Text="{Binding AbilityList[4]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="5" Grid.Row="0" Text="{Binding AbilityList[5]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="0" Grid.Row="1" Text="{Binding AbilityList[6]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding AbilityList[7]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="2" Grid.Row="1" Text="{Binding AbilityList[8]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="3" Grid.Row="1" Text="{Binding AbilityList[9]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="4" Grid.Row="1" Text="{Binding AbilityList[10]}" Margin="5,5,5,5"/>
                                        <TextBlock Grid.Column="5" Grid.Row="1" Text="{Binding AbilityList[11]}" Margin="5,5,5,5"/>
                                    </Grid>
                                    <ItemsControl ItemsSource="{Binding BestSequenceAbilityList}" Margin="0,10,0,0"/>
                                </StackPanel>
                            </Expander>
                        </DockPanel>
                    </DataTemplate>
                </TabItem.Resources>
                <DockPanel>
                    <DockPanel DockPanel.Dock="Top" Margin="5,5,5,5">
                        <TextBlock DockPanel.Dock="Left" VerticalAlignment="Center">Category:</TextBlock>
                        <ComboBox DockPanel.Dock="Left" SelectedIndex="{Binding CruncherCategoryIndex}" VerticalAlignment="Center" Margin="5,0,0,0">
                            <ComboBoxItem>
                                <TextBlock>DPS</TextBlock>
                            </ComboBoxItem>
                        </ComboBox>
                        <Button DockPanel.Dock="Right" Command="{StaticResource CrunchCommand}" VerticalAlignment="Center" Width="120" Margin="0,0,5,0">Crunch!</Button>
                        <ProgressBar Minimum="0" Maximum="1" Value="{Binding CrunchProgress, FallbackValue=0}" Visibility="{Binding IsCrunching, Converter={StaticResource convBooleanToObject}, ConverterParameter={StaticResource HiddenVisible}, FallbackValue=Hidden}" Margin="10,0,10,0"/>
                    </DockPanel>
                    <Grid>
                        <ScrollViewer>
                            <ItemsControl ItemsSource="{Binding CrunchSelectionList}" ItemTemplate="{StaticResource CrunchSelectionTemplate}"/>
                        </ScrollViewer>
                    </Grid>
                </DockPanel>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
